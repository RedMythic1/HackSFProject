============ STARTING PROGRAM ============
Python version: 3.13.2 (v3.13.2:4f8bb3947cf, Feb  4 2025, 11:51:10) [Clang 15.0.0 (clang-1500.3.9.4)]
Current working directory: /Users/avneh/Code/HackSFProject
Arguments: ['stockbt/st.py', 'Buy when price rises for 2 days, sell when it falls']
Using command line argument as user input: Buy when price rises for 2 days, sell when it fall...

=== STARTING ITERATIVE IMPROVEMENT PROCESS ===

--- IMPROVEMENT ITERATION 1/5 ---
[ITER 1] Loading data from stockbt/datasets/test.csv
Loaded 10251 data points for this iteration.

=== DEBUG: Starting run_simulation with user input: Buy when price rises for 2 days, sell when it fall... ===

Starting simulation iteration 1 with user input: Buy when price rises for 2 days, sell when it fallsâ€¦
CRITICAL ERROR IN MAIN: name 'shares_to_buy' is not defined
Traceback (most recent call last):
  File "/Users/avneh/Code/HackSFProject/stockbt/st.py", line 1308, in <module>
    run_improved_simulation(user_input)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/avneh/Code/HackSFProject/stockbt/st.py", line 1131, in run_improved_simulation
    current_profit, buy_points, sell_points, balance_over_time, code_info = run_simulation(
                                                                            ~~~~~~~~~~~~~~^
        user_input,
        ^^^^^^^^^^^
    ...<4 lines>...
        max_error_attempts
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/avneh/Code/HackSFProject/stockbt/st.py", line 613, in run_simulation
    #       print(f"Bought {shares_to_buy} shares at {buy_price:.2f} with {commission:.2f} commission on day {i} (price: {price_today:.2f})")
NameError: name 'shares_to_buy' is not defined
