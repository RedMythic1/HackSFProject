(()=>{"use strict";var t=function(){return t=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},t.apply(this,arguments)},e=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function s(t){try{c(o.next(t))}catch(t){i(t)}}function a(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((o=o.apply(t,e||[])).next())}))},n=function(t,e){var n,o,r,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(t){a=[6,t],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},o=function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))},r=function(){function t(){}return t.preprocess=function(t){return t.toLowerCase().replace(/[^a-z0-9\s]/g,"").split(/\s+/).filter(Boolean)},t.levenshteinSimilarity=function(t,e){var n=t.length,o=e.length;if(0===n||0===o)return 0;for(var r=Array.from({length:n+1},(function(){return Array(o+1).fill(0)})),i=0;i<=n;i++)r[i][0]=i;for(var s=0;s<=o;s++)r[0][s]=s;for(i=1;i<=n;i++)for(s=1;s<=o;s++){var a=t[i-1]===e[s-1]?0:1;r[i][s]=Math.min(r[i-1][s]+1,r[i][s-1]+1,r[i-1][s-1]+a)}return 100*(1-r[n][o]/Math.max(n,o))},t.jaccardSimilarity=function(t,e){var n=new Set(t),r=new Set(e),i=Array.from(n).filter((function(t){return r.has(t)})).length,s=Array.from(new Set(o(o([],t,!0),e,!0))).length;return 0===s?0:i/s*100},t.tokenOverlap=function(t,e){for(var n=0,o=0,r=t;o<r.length;o++){var i=r[o];e.includes(i)&&n++}return 0===t.length?0:n/t.length*100},t.compute=function(t,e){var n=this.preprocess(t),o=this.preprocess(e),r=n.join(" "),i=o.join(" "),s=.4*this.levenshteinSimilarity(r,i)+.3*this.jaccardSimilarity(n,o)+.3*this.tokenOverlap(n,o);return Math.round(s)},t}(),i=function(){function t(){this.baseUrl="",this.baseUrl="localhost"===window.location.hostname?"http://localhost:3000":"",console.log("ApiService initialized with baseUrl: ".concat(this.baseUrl)),console.log("Current hostname: ".concat(window.location.hostname))}return t.prototype.getArticles=function(t){return e(this,void 0,void 0,(function(){var e,o,r,i,s;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),e=t?"?interests=".concat(encodeURIComponent(t)):"",o="".concat(this.baseUrl,"/api/articles").concat(e),console.log("Fetching articles from: ".concat(o)),[4,fetch(o)];case 1:if(!(r=n.sent()).ok)throw console.error("Error response from server: ".concat(r.status)),new Error("Failed to fetch articles: ".concat(r.statusText));return[4,r.json()];case 2:return i=n.sent(),console.log("Articles fetched successfully. Count: ".concat(i.length)),console.log("Sample article data:",i.length>0?i[0]:"No articles"),[2,i.map((function(t){return{id:t.id||"",title:t.title||"Untitled Article",subject:t.subject||"",link:t.link||"",score:t.score||0,summary:t.summary||""}}))];case 3:return s=n.sent(),console.error("Error fetching articles:",s),[2,[]];case 4:return[2]}}))}))},t.prototype.getArticleDetails=function(t){return e(this,void 0,void 0,(function(){var e,o,r,i;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),e="".concat(this.baseUrl,"/api/article/").concat(t),console.log("Fetching article details from: ".concat(e)),[4,fetch(e)];case 1:if(!(o=n.sent()).ok)throw console.error("Error response from server: ".concat(o.status)),new Error("Failed to fetch article details: ".concat(o.statusText));return[4,o.json()];case 2:return r=n.sent(),console.log("Article details response:",r),"success"===r.status&&r.article?(console.log("Article details fetched successfully:",r.article.title),[2,{title:r.article.title,link:r.article.link,summary:r.article.summary,content:r.article.content}]):(console.error("Invalid article data format:",r),[2,null]);case 3:return i=n.sent(),console.error("Error fetching article details:",i),[2,null];case 4:return[2]}}))}))},t.prototype.analyzeInterests=function(t){return e(this,void 0,void 0,(function(){var e,o;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,fetch("".concat(this.baseUrl,"/api/analyze-interests"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({interests:t})})];case 1:if(!(e=n.sent()).ok)throw new Error("Failed to analyze interests");return[4,e.json()];case 2:return[2,n.sent()];case 3:return o=n.sent(),console.error("Error analyzing interests:",o),[2,null];case 4:return[2]}}))}))},t}(),s=function(){function o(){this.apiService=new i,this.articlesContainer=document.getElementById("articles-container"),this.interestsInput=document.getElementById("interests-input"),this.submitButton=document.getElementById("submit-interests"),this.initEventListeners(),this.loadArticles()}return o.prototype.initEventListeners=function(){var t=this;this.submitButton&&this.submitButton.addEventListener("click",(function(){return t.handleInterestsSubmit()}))},o.prototype.loadArticles=function(o){return e(this,void 0,void 0,(function(){var i,s,a,c,l,u;return n(this,(function(d){switch(d.label){case 0:if(!this.articlesContainer)return[2];d.label=1;case 1:return d.trys.push([1,4,,5]),console.log("Loading articles with interests: ".concat(o||"none")),this.articlesContainer.innerHTML='<div class="loading">Loading articles...</div>',[4,this.apiService.getArticles(o)];case 2:return 0===(i=d.sent()).length?(this.articlesContainer.innerHTML='<div class="message">No articles found. Please try with different interests.</div>',[2]):(console.log("Fetched ".concat(i.length," articles, now scoring based on interests: ").concat(o||"none")),s=this.deduplicateArticles(i),console.log("Reduced to ".concat(s.length," unique articles after deduplication")),a=s.map((function(t){return function(t,o,i){return e(void 0,void 0,void 0,(function(){var e,s,a,c,l,u,d,p,h,m,f,g,v,y,b,x,w,C,E,S,A,L,k,T,F,I,M,N,O,j,R,H;return n(this,(function(n){switch(n.label){case 0:if(n.trys.push([0,10,,11]),console.log('\n========== SCORING ARTICLE: "'.concat(t.title,'" (ID: ').concat(t.id||"unknown",") ==========")),console.log('Interest Terms: "'.concat(o,'"')),e=Math.floor(25*Math.random())+70,console.log("Base score (if no interests): ".concat(e)),!o.trim())return console.log("No interests provided - Using base score: ".concat(e)),[2,e];if(s=o.toLowerCase().split(/[\s,]+/).filter((function(t){return t.length>2})).map((function(t){return t.trim()})),console.log("Parsed interest terms (".concat(s.length,"):"),s),0===s.length)return console.log("No valid interest terms after filtering - Using base score: ".concat(e)),[2,e];if(a="",c="none",!t.id)return[3,8];n.label=1;case 1:return n.trys.push([1,6,,7]),l=".cache/summary_".concat(t.id,".json"),console.log("ATTEMPTING TO LOAD SUMMARY FILE: ".concat(l)),[4,fetch(l)];case 2:return u=n.sent(),console.log("Summary file response status:",u.status,u.statusText),u.ok?[4,u.json()]:[3,4];case 3:return d=n.sent(),console.log("Summary file raw data:",d),d.summary&&"string"==typeof d.summary?(a=d.summary,c="cache file",console.log("SUCCESS: Loaded summary from file (".concat(a.length," chars)")),console.log('Summary preview: "'.concat(a.substring(0,100)).concat(a.length>100?"...":"",'"'))):console.warn("File loaded but no valid summary found in data"),[3,5];case 4:console.warn("Failed to load summary file: ".concat(u.status," ").concat(u.statusText)),n.label=5;case 5:return[3,7];case 6:return p=n.sent(),console.warn("Error loading summary for article id ".concat(t.id,":"),p),[3,7];case 7:return[3,9];case 8:console.log("No article ID available - Cannot load summary file"),n.label=9;case 9:return!a&&t.summary?(a=t.summary,c="article object",console.log("FALLBACK: Using summary from article object (".concat(a.length," chars)")),console.log('Summary preview: "'.concat(a.substring(0,100)).concat(a.length>100?"...":"",'"'))):a||console.log("WARNING: No summary available from any source!"),console.log("Final summary source: ".concat(c)),console.log("Final summary length: ".concat(a.length," characters")),h=t.title,m=t.subject||"",f="".concat(h," ").concat(m," ").concat(a),console.log("\n----- SCORING COMPONENT 1: TEXT SIMILARITY (0-60 points) -----"),g=0,f.length>0?(console.log("Computing text similarity using advanced methods..."),v=r.compute(o,f),console.log("Raw similarity score: ".concat(v," / 100")),g=v/100*60,console.log("Weighted similarity score: ".concat(g.toFixed(2)," / 60 points")),y=r.preprocess(o),b=r.preprocess(f),x=r.levenshteinSimilarity(y.join(" "),b.slice(0,200).join(" ")),w=r.jaccardSimilarity(y,b),C=r.tokenOverlap(y,b),console.log("Similarity metrics breakdown:\n  - Levenshtein similarity: ".concat(x.toFixed(2),"%\n  - Jaccard similarity:     ").concat(w.toFixed(2),"%\n  - Token overlap:          ").concat(C.toFixed(2),"%"))):console.log("Empty article content - Similarity score: 0 / 60 points"),console.log("\n----- SCORING COMPONENT 2: CONTEXTUAL RELEVANCE (0-30 points) -----"),E=0,(S=o.split(/\s+/).some((function(e){return t.title.toLowerCase().includes(e.toLowerCase())}))?2:1)>1&&console.log("Interest terms found in title: applying ".concat(S,"x title importance multiplier")),A=r.compute(o,h)*S,console.log("Title similarity: ".concat((A/S).toFixed(2),"% (raw) × ").concat(S," = ").concat(A.toFixed(2),"%")),L=m?r.compute(o,m):0,console.log("Subject similarity: ".concat(L.toFixed(2),"%")),k=.7*A+.3*L,console.log("Weighted context similarity: ".concat(k.toFixed(2),"%")),E=k/100*30,console.log("Contextual relevance score: ".concat(E.toFixed(2)," / 30 points")),console.log("\n----- SCORING COMPONENT 3: FRESHNESS & UNIQUENESS (0-10 points) -----"),T=0,F=t.id?parseInt(t.id.replace(/\D/g,"").slice(-2)||"0")%8:Math.floor(8*Math.random()),console.log("Base freshness: ".concat(F," / 8")),I=i.map((function(t){return t.title.toLowerCase()})),M=h.toLowerCase().split(/\s+/).filter((function(t){return t.length>4})),N=0,M.forEach((function(t){var e=I.filter((function(e){return e.includes(t)})).length;e<=Math.max(1,Math.floor(.2*i.length))&&(N++,console.log('  Uncommon word found: "'.concat(t,'" (in ').concat(e," articles)")))})),O=Math.min(2,.5*N),console.log("Uniqueness bonus: ".concat(O.toFixed(2)," points (").concat(N," uncommon words)")),T=F+O,console.log("Freshness & uniqueness score: ".concat(T.toFixed(2)," / 10 points")),console.log("\n----- FINAL SCORE CALCULATION -----"),j=g+E+T,console.log("Final score breakdown:\n  - Text Similarity:         ".concat(g.toFixed(2)," / 60\n  - Contextual Relevance:    ").concat(E.toFixed(2)," / 30\n  - Freshness & Uniqueness:  ").concat(T.toFixed(2)," / 10\n  ----------------------\n  TOTAL SCORE:               ").concat(j.toFixed(2)," / 100\n")),R={similarity:g.toFixed(2),contextual:E.toFixed(2),freshness:T.toFixed(2),final:j.toFixed(2)},console.log("Score components stored:",R),t.scoreComponents=R,console.log("\n----- SCORING COMPLETE -----"),[2,Math.min(100,Math.max(0,j))];case 10:return H=n.sent(),console.error("ERROR IN RANKING SYSTEM:",H),[2,Math.floor(25*Math.random())+70];case 11:return[2]}}))}))}(t,o||"",s)})),[4,Promise.all(a)]);case 3:return c=d.sent(),l=s.map((function(e,n){return t(t({},e),{score:Math.round(c[n])})})),console.log("Scored ".concat(l.length," articles using custom ranking system")),l.sort((function(t,e){return e.score-t.score})),console.log("Articles sorted by score"),this.renderArticles(l),[3,5];case 4:return u=d.sent(),console.error("Error loading articles:",u),this.articlesContainer.innerHTML='<div class="error">Error loading articles. Please try again later.</div>',[3,5];case 5:return[2]}}))}))},o.prototype.deduplicateArticles=function(t){var e=new Set;return t.filter((function(t){var n=t.title.toLowerCase().trim();return!e.has(n)&&(e.add(n),!0)}))},o.prototype.renderArticles=function(t){var e=this;if(this.articlesContainer){console.log("Rendering ".concat(t.length," articles")),this.articlesContainer.innerHTML="";var n=document.createElement("div");n.className="articles-grid",n.style.display="grid",n.style.gridTemplateColumns="repeat(auto-fill, minmax(300px, 1fr))",n.style.gap="20px",n.style.padding="10px",t.forEach((function(t){var o;if("id"in t&&t.id)o=t.id;else{var r=t.link.split("/");if(!(o=r[r.length-1])||"#"===o){var i=t.title.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");o="".concat(i,"-").concat(Date.now().toString().slice(-6))}}console.log('Rendering article: "'.concat(t.title,'" (ID: ').concat(o,")"));var s=t.summary||"";s&&""!==s.trim()||(s=t.subject||"No introduction available");var a=t.title;a.toLowerCase().startsWith("deep dive:")&&(a=a.replace(/^deep dive:/i,"").trim());var c=document.createElement("div");c.className="article-card",c.style.border="1px solid #e0e0e0",c.style.borderRadius="8px",c.style.overflow="hidden",c.style.boxShadow="0 4px 6px rgba(0, 0, 0, 0.1)",c.style.backgroundColor="#ffffff",c.style.transition="transform 0.2s, box-shadow 0.2s",c.style.height="100%",c.style.display="flex",c.style.flexDirection="column",c.addEventListener("mouseenter",(function(){c.style.transform="translateY(-5px)",c.style.boxShadow="0 8px 15px rgba(0, 0, 0, 0.1)"})),c.addEventListener("mouseleave",(function(){c.style.transform="translateY(0)",c.style.boxShadow="0 4px 6px rgba(0, 0, 0, 0.1)"}));var l,u=(l=t.score)>90?"#4CAF50":l>75?"#2196F3":l>60?"#FF9800":"#9E9E9E";c.innerHTML='\n                <div class="article-header" style="padding: 15px; position: relative;">\n                    <div style="position: absolute; top: 15px; right: 15px; background-color: '.concat(u,'; color: white; padding: 5px 10px; border-radius: 12px; font-weight: bold; font-size: 14px;">\n                        ').concat(t.score,'\n                    </div>\n                    <h3 class="article-title" style="margin-top: 0; margin-bottom: 10px; font-size: 18px; color: #333; padding-right: 60px;">').concat(e.escapeHtml(a),'</h3>\n                    <div class="article-subject" style="font-size: 14px; color: #666; margin-bottom: 15px;">').concat(e.escapeHtml(t.subject||""),'</div>\n                    <div class="score-breakdown" style="background-color: #f9f9f9; border-radius: 5px; padding: 10px; margin-top: 10px; display: none;">\n                        <div style="margin-bottom: 8px;">\n                            <div style="height: 6px; background-color: #e0e0e0; border-radius: 3px; overflow: hidden;">\n                                <div style="height: 100%; width: ').concat(Math.min(100,t.score),"%; background-color: ").concat(u,';"></div>\n                            </div>\n                        </div>\n                        ').concat(t.scoreComponents?'\n                        <div style="font-size: 12px; color: #555;">\n                            <div style="display: flex; justify-content: space-between; margin-bottom: 2px;">\n                                <span>Keywords:</span>\n                                <span>'.concat(t.scoreComponents.similarity,'/60</span>\n                            </div>\n                            <div style="display: flex; justify-content: space-between; margin-bottom: 2px;">\n                                <span>Contextual:</span>\n                                <span>').concat(t.scoreComponents.contextual,'/30</span>\n                            </div>\n                            <div style="display: flex; justify-content: space-between;">\n                                <span>Freshness:</span>\n                                <span>').concat(t.scoreComponents.freshness,"/10</span>\n                            </div>\n                        </div>"):"",'\n                        <div style="text-align: center; margin-top: 5px; font-size: 12px; color: #888; cursor: pointer;" class="toggle-details">Show less</div>\n                    </div>\n                    <div style="text-align: center; margin-top: 5px; font-size: 12px; color: #888; cursor: pointer;" class="toggle-details">Show score details</div>\n                </div>\n                <div class="article-body" style="padding: 15px; border-top: 1px solid #eeeeee; flex-grow: 1; display: flex; flex-direction: column;">\n                    <div class="article-introduction" style="flex-grow: 1;">\n                        <p style="margin-top: 0; line-height: 1.5; color: #444; font-size: 14px;">').concat(e.truncateText(s,150),'</p>\n                    </div>\n                    <a href="#" class="article-link" data-article-id="').concat(o,'" style="display: inline-block; padding: 8px 15px; background-color: #2196F3; color: white; text-decoration: none; border-radius: 4px; text-align: center; margin-top: 15px; font-weight: 500; transition: background-color 0.2s;">Read more</a>\n                </div>\n            ');var d=c.querySelector(".article-link");d&&d.addEventListener("click",(function(t){t.preventDefault();var n=d.getAttribute("data-article-id");n?e.viewArticleDetails(n):console.error("Missing article ID in data attribute")}));var p=c.querySelectorAll(".toggle-details");if(2===p.length){var h=p[1],m=p[0],f=c.querySelector(".score-breakdown");h.addEventListener("click",(function(){f.style.display="block",h.style.display="none"})),m.addEventListener("click",(function(){f.style.display="none",h.style.display="block"}))}n.appendChild(c)})),this.articlesContainer.appendChild(n);var o=document.createElement("div");o.className="debug-info",o.textContent="Displaying ".concat(t.length," unique articles"),o.style.textAlign="center",o.style.marginTop="20px",o.style.fontSize="12px",o.style.color="#888",this.articlesContainer.appendChild(o)}},o.prototype.viewArticleDetails=function(t){return e(this,void 0,void 0,(function(){var e,o,r,i=this;return n(this,(function(n){switch(n.label){case 0:if(!this.articlesContainer)return[2];this.articlesContainer.innerHTML='<div class="loading">Loading article details...</div>',n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.apiService.getArticleDetails(t)];case 2:return(e=n.sent())?(this.renderArticleDetail(e),[3,4]):(this.articlesContainer.innerHTML='<div class="error">Article not found</div>',(r=document.createElement("button")).textContent="Back to Articles",r.className="back-button",r.addEventListener("click",(function(){var t,e=(null===(t=i.interestsInput)||void 0===t?void 0:t.value)||"";i.loadArticles(e)})),this.articlesContainer.appendChild(r),[2]);case 3:return o=n.sent(),console.error("Error loading article details:",o),this.articlesContainer.innerHTML='<div class="error">Error loading article details. Please try again later.</div>',(r=document.createElement("button")).textContent="Back to Articles",r.className="back-button",r.addEventListener("click",(function(){var t,e=(null===(t=i.interestsInput)||void 0===t?void 0:t.value)||"";i.loadArticles(e)})),this.articlesContainer.appendChild(r),[3,4];case 4:return[2]}}))}))},o.prototype.renderArticleDetail=function(t){var e=this;if(this.articlesContainer){this.articlesContainer.innerHTML="";var n=document.createElement("div");n.className="article-detail";var o="\n            <h2>".concat(this.escapeHtml(t.title),"</h2>\n        ");t.content?t.content.includes("<")&&t.content.includes(">")?o+='\n                    <div class="article-content">\n                        '.concat(this.sanitizeHtml(t.content),"\n                    </div>\n                "):o+='\n                    <div class="article-content">\n                        '.concat(this.formatSummary(t.content),"\n                    </div>\n                "):o+='\n                <div class="article-summary">\n                    '.concat(this.formatSummary(t.summary),"\n                </div>\n            "),o+='\n            <div class="article-actions">\n                <a href="'.concat(t.link,'" target="_blank" class="article-link">View Original</a>\n                <button id="back-to-articles" class="back-button">Back to Articles</button>\n            </div>\n        '),n.innerHTML=o;var r=n.querySelector("#back-to-articles");r&&r.addEventListener("click",(function(){var t,n=(null===(t=e.interestsInput)||void 0===t?void 0:t.value)||"";e.loadArticles(n)})),this.articlesContainer.appendChild(n)}},o.prototype.handleInterestsSubmit=function(){var t=this;if(this.interestsInput){var e=this.interestsInput.value.trim();console.log('Interests submitted: "'.concat(e,'"')),this.submitButton&&(this.submitButton.setAttribute("disabled","true"),this.submitButton.textContent="Loading..."),this.articlesContainer&&(this.articlesContainer.innerHTML='<div class="loading">Scoring articles based on your interests...</div>'),this.loadArticles(e).finally((function(){t.submitButton&&(t.submitButton.removeAttribute("disabled"),t.submitButton.textContent="Update Interests")}))}},o.prototype.formatSummary=function(t){var e=this;return t.split("\n\n").filter((function(t){return t.trim().length>0})).map((function(t){return"<p>".concat(e.escapeHtml(t),"</p>")})).join("")},o.prototype.escapeHtml=function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},o.prototype.truncateText=function(t,e){return t?t.length<=e?this.escapeHtml(t):this.escapeHtml(t.substring(0,e))+"...":""},o.prototype.sanitizeHtml=function(t){var e=document.createElement("div");return e.innerHTML=t,e.querySelectorAll("script").forEach((function(t){return t.remove()})),e.querySelectorAll("iframe").forEach((function(t){return t.remove()})),e.querySelectorAll("*").forEach((function(t){Array.from(t.attributes).forEach((function(e){(e.name.startsWith("on")||"href"===e.name&&e.value.startsWith("javascript:"))&&t.removeAttribute(e.name)}))})),e.innerHTML},o}();document.addEventListener("DOMContentLoaded",(function(){new s}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUtwTixFQUNEQSxFQUFLVSxRQUFVME0sRUFBa0I3SyxLQUFLOEksV0FBV3JMLEdBQzlDdUMsS0FBSzhJLFdBQVdyTCxFQUFLNEcsVUFBVSxFQUFHd0csSUFBYyxNQUZyQyxFQUd0QixFQUdRLFlBQUFQLGFBQVIsU0FBcUJRLEdBRWpCLElBQU1DLEVBQVVsSSxTQUFTd0UsY0FBYyxPQW9CdkMsT0FuQkEwRCxFQUFRMUgsVUFBWXlILEVBR0pDLEVBQVF2QixpQkFBaUIsVUFDakN6RCxTQUFRLFNBQUFpRixHQUFVLE9BQUFBLEVBQU9DLFFBQVAsSUFFVkYsRUFBUXZCLGlCQUFpQixVQUNqQ3pELFNBQVEsU0FBQW1GLEdBQVUsT0FBQUEsRUFBT0QsUUFBUCxJQUdORixFQUFRdkIsaUJBQWlCLEtBQ2pDekQsU0FBUSxTQUFBb0YsR0FDaEI3TSxNQUFNQyxLQUFLNE0sRUFBR0MsWUFBWXJGLFNBQVEsU0FBQXNGLElBQzFCQSxFQUFLQyxLQUFLcEQsV0FBVyxPQUF1QixTQUFkbUQsRUFBS0MsTUFBbUJELEVBQUtqQixNQUFNbEMsV0FBVyxpQkFDNUVpRCxFQUFHVCxnQkFBZ0JXLEVBQUtDLEtBRWhDLEdBQ0osSUFFT1AsRUFBUTFILFNBQ25CLEVBQ0osRUE1YUEsR0ErYUFSLFNBQVNNLGlCQUFpQixvQkFBb0IsV0FDMUMsSUFBSW9JLENBQ1IsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3R5cGVzY3JpcHQtd2VicGFnZS8uL3NyYy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnO1xuaW1wb3J0IHsgcGlwZWxpbmUgfSBmcm9tICdAeGVub3ZhL3RyYW5zZm9ybWVycyc7XG5pbXBvcnQgeyBzeW5jQ2FjaGUsIGdldENhY2hlZEFydGljbGUsIGdldENhY2hlZFN1bW1hcnksIGdldENhY2hlZFNlYXJjaCB9IGZyb20gJy4vdXRpbHMvY2FjaGVTeW5jJztcblxuLyoqXG4gKiBTaW1pbGFyaXR5U2NvcmVyIGNsYXNzIHByb3ZpZGVzIGEgZnVsbHkgb2ZmbGluZSBzaW1pbGFyaXR5IHNjb3JpbmcgYWxnb3JpdGhtIFxuICogZm9yIGNvbXBhcmluZyBzdHJpbmdzIG9uIGEgc2NhbGUgb2YgMC0xMDAgd2l0aCBoaWdoIGFjY3VyYWN5LlxuICovXG5jbGFzcyBTaW1pbGFyaXR5U2NvcmVyIHtcbiAgc3RhdGljIHByZXByb2Nlc3ModGV4dDogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIHJldHVybiB0ZXh0XG4gICAgICAudG9Mb3dlckNhc2UoKVxuICAgICAgLnJlcGxhY2UoL1teYS16MC05XFxzXS9nLCBcIlwiKVxuICAgICAgLnNwbGl0KC9cXHMrLylcbiAgICAgIC5maWx0ZXIoQm9vbGVhbik7XG4gIH1cblxuICBzdGF0aWMgbGV2ZW5zaHRlaW5TaW1pbGFyaXR5KGE6IHN0cmluZywgYjogc3RyaW5nKTogbnVtYmVyIHtcbiAgICBjb25zdCBtID0gYS5sZW5ndGgsIG4gPSBiLmxlbmd0aDtcbiAgICBpZiAobSA9PT0gMCB8fCBuID09PSAwKSByZXR1cm4gMDtcblxuICAgIGNvbnN0IGRwOiBudW1iZXJbXVtdID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogbSArIDEgfSwgKCkgPT4gQXJyYXkobiArIDEpLmZpbGwoMCkpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IG07IGkrKykgZHBbaV1bMF0gPSBpO1xuICAgIGZvciAobGV0IGogPSAwOyBqIDw9IG47IGorKykgZHBbMF1bal0gPSBqO1xuXG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gbTsgaSsrKSB7XG4gICAgICBmb3IgKGxldCBqID0gMTsgaiA8PSBuOyBqKyspIHtcbiAgICAgICAgY29uc3QgY29zdCA9IGFbaSAtIDFdID09PSBiW2ogLSAxXSA/IDAgOiAxO1xuICAgICAgICBkcFtpXVtqXSA9IE1hdGgubWluKFxuICAgICAgICAgIGRwW2kgLSAxXVtqXSArIDEsXG4gICAgICAgICAgZHBbaV1baiAtIDFdICsgMSxcbiAgICAgICAgICBkcFtpIC0gMV1baiAtIDFdICsgY29zdFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IGRpc3RhbmNlID0gZHBbbV1bbl07XG4gICAgY29uc3QgbWF4TGVuID0gTWF0aC5tYXgobSwgbik7XG4gICAgcmV0dXJuIDEwMCAqICgxIC0gZGlzdGFuY2UgLyBtYXhMZW4pOyAvLyBwZXJjZW50YWdlXG4gIH1cblxuICBzdGF0aWMgamFjY2FyZFNpbWlsYXJpdHkoYVRva2Vuczogc3RyaW5nW10sIGJUb2tlbnM6IHN0cmluZ1tdKTogbnVtYmVyIHtcbiAgICBjb25zdCBzZXRBID0gbmV3IFNldChhVG9rZW5zKTtcbiAgICBjb25zdCBzZXRCID0gbmV3IFNldChiVG9rZW5zKTtcbiAgICBjb25zdCBpbnRlcnNlY3Rpb24gPSBBcnJheS5mcm9tKHNldEEpLmZpbHRlcih4ID0+IHNldEIuaGFzKHgpKS5sZW5ndGg7XG4gICAgY29uc3QgdW5pb24gPSBBcnJheS5mcm9tKG5ldyBTZXQoWy4uLmFUb2tlbnMsIC4uLmJUb2tlbnNdKSkubGVuZ3RoO1xuICAgIHJldHVybiB1bmlvbiA9PT0gMCA/IDAgOiAoaW50ZXJzZWN0aW9uIC8gdW5pb24pICogMTAwO1xuICB9XG5cbiAgc3RhdGljIHRva2VuT3ZlcmxhcChhVG9rZW5zOiBzdHJpbmdbXSwgYlRva2Vuczogc3RyaW5nW10pOiBudW1iZXIge1xuICAgIGxldCBtYXRjaCA9IDA7XG4gICAgZm9yIChjb25zdCB3b3JkIG9mIGFUb2tlbnMpIHtcbiAgICAgIGlmIChiVG9rZW5zLmluY2x1ZGVzKHdvcmQpKSBtYXRjaCsrO1xuICAgIH1cbiAgICByZXR1cm4gYVRva2Vucy5sZW5ndGggPT09IDAgPyAwIDogKG1hdGNoIC8gYVRva2Vucy5sZW5ndGgpICogMTAwO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbXB1dGVzIGEgc2ltaWxhcml0eSBzY29yZSBiZXR3ZWVuIGEgc2hvcnQgc3RyaW5nIGFuZCBhIGxvbmdlciBzdHJpbmcuXG4gICAqIFxuICAgKiBAcGFyYW0gc21hbGwgLSBUaGUgc21hbGwgc3RyaW5nIG9yIHF1ZXJ5XG4gICAqIEBwYXJhbSBsYXJnZSAtIFRoZSBsYXJnZXIgY29udGVudCBzdHJpbmdcbiAgICogQHJldHVybnMgQSBudW1iZXIgZnJvbSAwIHRvIDEwMCBpbmRpY2F0aW5nIHNpbWlsYXJpdHlcbiAgICovXG4gIHN0YXRpYyBjb21wdXRlKHNtYWxsOiBzdHJpbmcsIGxhcmdlOiBzdHJpbmcpOiBudW1iZXIge1xuICAgIGNvbnN0IGFUb2tlbnMgPSB0aGlzLnByZXByb2Nlc3Moc21hbGwpO1xuICAgIGNvbnN0IGJUb2tlbnMgPSB0aGlzLnByZXByb2Nlc3MobGFyZ2UpO1xuICAgIGNvbnN0IHNtYWxsQ2xlYW4gPSBhVG9rZW5zLmpvaW4oXCIgXCIpO1xuICAgIGNvbnN0IGxhcmdlQ2xlYW4gPSBiVG9rZW5zLmpvaW4oXCIgXCIpO1xuXG4gICAgY29uc3QgbGV2ID0gdGhpcy5sZXZlbnNodGVpblNpbWlsYXJpdHkoc21hbGxDbGVhbiwgbGFyZ2VDbGVhbik7XG4gICAgY29uc3QgamFjID0gdGhpcy5qYWNjYXJkU2ltaWxhcml0eShhVG9rZW5zLCBiVG9rZW5zKTtcbiAgICBjb25zdCB0b2sgPSB0aGlzLnRva2VuT3ZlcmxhcChhVG9rZW5zLCBiVG9rZW5zKTtcblxuICAgIGNvbnN0IHNjb3JlID0gMC40ICogbGV2ICsgMC4zICogamFjICsgMC4zICogdG9rO1xuICAgIHJldHVybiBNYXRoLnJvdW5kKHNjb3JlKTtcbiAgfVxufVxuXG4vLyBEZWZpbmUgdGhlIHR5cGUgZm9yIGNhbGN1bGF0aW9uIGxvZyBzdGVwc1xuaW50ZXJmYWNlIENhbGN1bGF0aW9uU3RlcCB7XG4gICAgc3RlcDogc3RyaW5nO1xuICAgIHZhbHVlOiBhbnk7XG59XG5cbi8vIFVwZGF0ZSB0aGUgQVBJX1VSTCBjb25zdGFudCB0byB1c2UgcmVsYXRpdmUgcGF0aHMgZm9yIFZlcmNlbCBjb21wYXRpYmlsaXR5XG5jb25zdCBBUElfVVJMID0gJyc7ICAvLyBFbXB0eSBzdHJpbmcgZm9yIHJlbGF0aXZlIHBhdGhzXG5cbi8vIEFkZCBhIGN1c3RvbSBsb2dnZXJcbmNvbnN0IGxvZ1RvRmlsZSA9IGFzeW5jIChtZXNzYWdlOiBzdHJpbmcsIGxldmVsOiAnaW5mbycgfCAnZXJyb3InIHwgJ2RlYnVnJyA9ICdpbmZvJyk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgIHRyeSB7XG4gICAgICAgIC8vIExvZyB0byBjb25zb2xlXG4gICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgICAgICAgY29uc3QgZm9ybWF0dGVkTWVzc2FnZSA9IGBbJHt0aW1lc3RhbXB9XSBbJHtsZXZlbC50b1VwcGVyQ2FzZSgpfV0gJHttZXNzYWdlfWA7XG4gICAgICAgIFxuICAgICAgICAvLyBTdGFuZGFyZCBjb25zb2xlIGxvZ2dpbmdcbiAgICAgICAgaWYgKGxldmVsID09PSAnZXJyb3InKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGZvcm1hdHRlZE1lc3NhZ2UpO1xuICAgICAgICB9IGVsc2UgaWYgKGxldmVsID09PSAnZGVidWcnKSB7XG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKGZvcm1hdHRlZE1lc3NhZ2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZm9ybWF0dGVkTWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFNlbmQgbG9nIHRvIGJhY2tlbmQgdG8gd3JpdGUgdG8gZmlsZVxuICAgICAgICBhd2FpdCBmZXRjaChgJHtBUElfVVJMfS9sb2dgLCB7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGZvcm1hdHRlZE1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgbGV2ZWwsXG4gICAgICAgICAgICAgICAgc291cmNlOiAnZnJvbnRlbmQnXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAvLyBJZiBsb2dnaW5nIGZhaWxzLCBhdCBsZWFzdCBzaG93IGluIGNvbnNvbGVcbiAgICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIGxvZyB0byBmaWxlOiAke2Vycm9yfWApO1xuICAgIH1cbn07XG5cbmludGVyZmFjZSBBcnRpY2xlIHtcbiAgICB0aXRsZTogc3RyaW5nO1xuICAgIGxpbms6IHN0cmluZztcbiAgICBzdWJqZWN0OiBzdHJpbmc7XG4gICAgc2NvcmU6IG51bWJlcjtcbiAgICBzdW1tYXJ5Pzogc3RyaW5nO1xuICAgIGlkPzogc3RyaW5nO1xuICAgIHNjb3JlQ29tcG9uZW50cz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG59XG5cbmludGVyZmFjZSBBcnRpY2xlRGV0YWlsIHtcbiAgICB0aXRsZTogc3RyaW5nO1xuICAgIGxpbms6IHN0cmluZztcbiAgICBzdW1tYXJ5OiBzdHJpbmc7XG4gICAgY29udGVudD86IHN0cmluZztcbn1cblxuLy8gRGVmaW5lIHR5cGVzIGZvciB0aGUgemVyby1zaG90IGNsYXNzaWZpY2F0aW9uIHJlc3VsdHNcbmludGVyZmFjZSBaZXJvU2hvdENsYXNzaWZpY2F0aW9uT3V0cHV0IHtcbiAgICBzZXF1ZW5jZTogc3RyaW5nO1xuICAgIGxhYmVsczogc3RyaW5nW107XG4gICAgc2NvcmVzOiBudW1iZXJbXTtcbn1cblxuLyoqXG4gKiBDdXN0b20gcmFua2luZyBzeXN0ZW0gZm9yIGFydGljbGVzIC0gdXNlcyBhZHZhbmNlZCBzaW1pbGFyaXR5IHNjb3JpbmdcbiAqIEBwYXJhbSBhcnRpY2xlIEFydGljbGUgdG8gc2NvcmVcbiAqIEBwYXJhbSB1c2VySW50ZXJlc3RzIFVzZXIncyBzcGVjaWZpZWQgaW50ZXJlc3RzXG4gKiBAcGFyYW0gYXJ0aWNsZUNvbGxlY3Rpb24gRnVsbCBjb2xsZWN0aW9uIG9mIGFydGljbGVzIGZvciBjb250ZXh0dWFsIHJhbmtpbmdcbiAqIEByZXR1cm5zIEEgc2NvcmUgYmV0d2VlbiAwLTEwMFxuICovXG5jb25zdCBjdXN0b21SYW5raW5nU3lzdGVtID0gYXN5bmMgKFxuICAgIGFydGljbGU6IEFydGljbGUsIFxuICAgIHVzZXJJbnRlcmVzdHM6IHN0cmluZyxcbiAgICBhcnRpY2xlQ29sbGVjdGlvbjogQXJ0aWNsZVtdXG4pOiBQcm9taXNlPG51bWJlcj4gPT4ge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBcXG49PT09PT09PT09IFNDT1JJTkcgQVJUSUNMRTogXCIke2FydGljbGUudGl0bGV9XCIgKElEOiAke2FydGljbGUuaWQgfHwgJ3Vua25vd24nfSkgPT09PT09PT09PWApO1xuICAgICAgICBjb25zb2xlLmxvZyhgSW50ZXJlc3QgVGVybXM6IFwiJHt1c2VySW50ZXJlc3RzfVwiYCk7XG4gICAgICAgIFxuICAgICAgICAvLyBCYXNlIHNjb3JlICg3MC05NSByYW5nZSlcbiAgICAgICAgbGV0IGJhc2VTY29yZSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDI1KSArIDcwO1xuICAgICAgICBjb25zb2xlLmxvZyhgQmFzZSBzY29yZSAoaWYgbm8gaW50ZXJlc3RzKTogJHtiYXNlU2NvcmV9YCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIXVzZXJJbnRlcmVzdHMudHJpbSgpKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgTm8gaW50ZXJlc3RzIHByb3ZpZGVkIC0gVXNpbmcgYmFzZSBzY29yZTogJHtiYXNlU2NvcmV9YCk7XG4gICAgICAgICAgICByZXR1cm4gYmFzZVNjb3JlOyAvLyBEZWZhdWx0IHNjb3JlIGlmIG5vIGludGVyZXN0c1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBQcm9jZXNzIGludGVyZXN0IHRlcm1zXG4gICAgICAgIGNvbnN0IGludGVyZXN0VGVybXMgPSB1c2VySW50ZXJlc3RzXG4gICAgICAgICAgICAudG9Mb3dlckNhc2UoKVxuICAgICAgICAgICAgLnNwbGl0KC9bXFxzLF0rLylcbiAgICAgICAgICAgIC5maWx0ZXIodGVybSA9PiB0ZXJtLmxlbmd0aCA+IDIpXG4gICAgICAgICAgICAubWFwKHRlcm0gPT4gdGVybS50cmltKCkpO1xuICAgICAgICBcbiAgICAgICAgY29uc29sZS5sb2coYFBhcnNlZCBpbnRlcmVzdCB0ZXJtcyAoJHtpbnRlcmVzdFRlcm1zLmxlbmd0aH0pOmAsIGludGVyZXN0VGVybXMpO1xuICAgICAgICBcbiAgICAgICAgaWYgKGludGVyZXN0VGVybXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgTm8gdmFsaWQgaW50ZXJlc3QgdGVybXMgYWZ0ZXIgZmlsdGVyaW5nIC0gVXNpbmcgYmFzZSBzY29yZTogJHtiYXNlU2NvcmV9YCk7XG4gICAgICAgICAgICByZXR1cm4gYmFzZVNjb3JlOyAvLyBObyB2YWxpZCBpbnRlcmVzdCB0ZXJtc1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBMb2FkIHN1bW1hcnkgZnJvbSAuY2FjaGUvc3VtbWFyeV97YXJ0aWNsZS5pZH0uanNvbiBpZiBwb3NzaWJsZVxuICAgICAgICBsZXQgYXJ0aWNsZVN1bW1hcnkgPSAnJztcbiAgICAgICAgbGV0IHN1bW1hcnlTb3VyY2UgPSAnbm9uZSc7XG4gICAgICAgIFxuICAgICAgICBpZiAoYXJ0aWNsZS5pZCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBzdW1tYXJ5UGF0aCA9IGAuY2FjaGUvc3VtbWFyeV8ke2FydGljbGUuaWR9Lmpzb25gO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBBVFRFTVBUSU5HIFRPIExPQUQgU1VNTUFSWSBGSUxFOiAke3N1bW1hcnlQYXRofWApO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goc3VtbWFyeVBhdGgpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBTdW1tYXJ5IGZpbGUgcmVzcG9uc2Ugc3RhdHVzOmAsIHJlc3BvbnNlLnN0YXR1cywgcmVzcG9uc2Uuc3RhdHVzVGV4dCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHN1bW1hcnlEYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgU3VtbWFyeSBmaWxlIHJhdyBkYXRhOmAsIHN1bW1hcnlEYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmIChzdW1tYXJ5RGF0YS5zdW1tYXJ5ICYmIHR5cGVvZiBzdW1tYXJ5RGF0YS5zdW1tYXJ5ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJ0aWNsZVN1bW1hcnkgPSBzdW1tYXJ5RGF0YS5zdW1tYXJ5O1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VtbWFyeVNvdXJjZSA9ICdjYWNoZSBmaWxlJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBTVUNDRVNTOiBMb2FkZWQgc3VtbWFyeSBmcm9tIGZpbGUgKCR7YXJ0aWNsZVN1bW1hcnkubGVuZ3RofSBjaGFycylgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBTdW1tYXJ5IHByZXZpZXc6IFwiJHthcnRpY2xlU3VtbWFyeS5zdWJzdHJpbmcoMCwgMTAwKX0ke2FydGljbGVTdW1tYXJ5Lmxlbmd0aCA+IDEwMCA/ICcuLi4nIDogJyd9XCJgKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgRmlsZSBsb2FkZWQgYnV0IG5vIHZhbGlkIHN1bW1hcnkgZm91bmQgaW4gZGF0YWApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBGYWlsZWQgdG8gbG9hZCBzdW1tYXJ5IGZpbGU6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBFcnJvciBsb2FkaW5nIHN1bW1hcnkgZm9yIGFydGljbGUgaWQgJHthcnRpY2xlLmlkfTpgLCBlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYE5vIGFydGljbGUgSUQgYXZhaWxhYmxlIC0gQ2Fubm90IGxvYWQgc3VtbWFyeSBmaWxlYCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmICghYXJ0aWNsZVN1bW1hcnkgJiYgYXJ0aWNsZS5zdW1tYXJ5KSB7XG4gICAgICAgICAgICBhcnRpY2xlU3VtbWFyeSA9IGFydGljbGUuc3VtbWFyeTtcbiAgICAgICAgICAgIHN1bW1hcnlTb3VyY2UgPSAnYXJ0aWNsZSBvYmplY3QnO1xuICAgICAgICAgICAgY29uc29sZS5sb2coYEZBTExCQUNLOiBVc2luZyBzdW1tYXJ5IGZyb20gYXJ0aWNsZSBvYmplY3QgKCR7YXJ0aWNsZVN1bW1hcnkubGVuZ3RofSBjaGFycylgKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBTdW1tYXJ5IHByZXZpZXc6IFwiJHthcnRpY2xlU3VtbWFyeS5zdWJzdHJpbmcoMCwgMTAwKX0ke2FydGljbGVTdW1tYXJ5Lmxlbmd0aCA+IDEwMCA/ICcuLi4nIDogJyd9XCJgKTtcbiAgICAgICAgfSBlbHNlIGlmICghYXJ0aWNsZVN1bW1hcnkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBXQVJOSU5HOiBObyBzdW1tYXJ5IGF2YWlsYWJsZSBmcm9tIGFueSBzb3VyY2UhYCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGNvbnNvbGUubG9nKGBGaW5hbCBzdW1tYXJ5IHNvdXJjZTogJHtzdW1tYXJ5U291cmNlfWApO1xuICAgICAgICBjb25zb2xlLmxvZyhgRmluYWwgc3VtbWFyeSBsZW5ndGg6ICR7YXJ0aWNsZVN1bW1hcnkubGVuZ3RofSBjaGFyYWN0ZXJzYCk7XG4gICAgICAgIFxuICAgICAgICAvLyBQcmVwYXJlIGFydGljbGUgY29udGVudCBmb3Igc2ltaWxhcml0eSBzY29yaW5nXG4gICAgICAgIGNvbnN0IHRpdGxlVGV4dCA9IGFydGljbGUudGl0bGU7XG4gICAgICAgIGNvbnN0IHN1YmplY3RUZXh0ID0gYXJ0aWNsZS5zdWJqZWN0IHx8ICcnO1xuICAgICAgICBcbiAgICAgICAgLy8gQ3JlYXRlIGZ1bGwgdGV4dCByZXByZXNlbnRhdGlvbiBmb3IgdGhlIGFydGljbGVcbiAgICAgICAgY29uc3QgYXJ0aWNsZUZ1bGxUZXh0ID0gYCR7dGl0bGVUZXh0fSAke3N1YmplY3RUZXh0fSAke2FydGljbGVTdW1tYXJ5fWA7XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZyhgXFxuLS0tLS0gU0NPUklORyBDT01QT05FTlQgMTogVEVYVCBTSU1JTEFSSVRZICgwLTYwIHBvaW50cykgLS0tLS1gKTtcbiAgICAgICAgLy8gLS0tLSAxLiBURVhUIFNJTUlMQVJJVFkgU0NPUklORyAoMC02MCBwb2ludHMpIC0tLS1cbiAgICAgICAgbGV0IHNpbWlsYXJpdHlTY29yZSA9IDA7XG4gICAgICAgIFxuICAgICAgICBpZiAoYXJ0aWNsZUZ1bGxUZXh0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBDb21wdXRpbmcgdGV4dCBzaW1pbGFyaXR5IHVzaW5nIGFkdmFuY2VkIG1ldGhvZHMuLi5gKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIHNpbWlsYXJpdHkgYmV0d2VlbiB1c2VyIGludGVyZXN0cyBhbmQgYXJ0aWNsZSBjb250ZW50XG4gICAgICAgICAgICBjb25zdCByYXdTaW1pbGFyaXR5ID0gU2ltaWxhcml0eVNjb3Jlci5jb21wdXRlKHVzZXJJbnRlcmVzdHMsIGFydGljbGVGdWxsVGV4dCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgUmF3IHNpbWlsYXJpdHkgc2NvcmU6ICR7cmF3U2ltaWxhcml0eX0gLyAxMDBgKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gV2VpZ2h0IHRoZSBzaW1pbGFyaXR5IHNjb3JlIChtYXggNjAgcG9pbnRzKVxuICAgICAgICAgICAgc2ltaWxhcml0eVNjb3JlID0gKHJhd1NpbWlsYXJpdHkgLyAxMDApICogNjA7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgV2VpZ2h0ZWQgc2ltaWxhcml0eSBzY29yZTogJHtzaW1pbGFyaXR5U2NvcmUudG9GaXhlZCgyKX0gLyA2MCBwb2ludHNgKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gRGV0YWlsZWQgc2ltaWxhcml0eSBicmVha2Rvd25cbiAgICAgICAgICAgIGNvbnN0IGludGVyZXN0VG9rZW5zID0gU2ltaWxhcml0eVNjb3Jlci5wcmVwcm9jZXNzKHVzZXJJbnRlcmVzdHMpO1xuICAgICAgICAgICAgY29uc3QgYXJ0aWNsZVRva2VucyA9IFNpbWlsYXJpdHlTY29yZXIucHJlcHJvY2VzcyhhcnRpY2xlRnVsbFRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgaW5kaXZpZHVhbCBtZXRyaWNzIGZvciBsb2dnaW5nXG4gICAgICAgICAgICBjb25zdCBsZXZTaW0gPSBTaW1pbGFyaXR5U2NvcmVyLmxldmVuc2h0ZWluU2ltaWxhcml0eShcbiAgICAgICAgICAgICAgICBpbnRlcmVzdFRva2Vucy5qb2luKFwiIFwiKSwgXG4gICAgICAgICAgICAgICAgYXJ0aWNsZVRva2Vucy5zbGljZSgwLCAyMDApLmpvaW4oXCIgXCIpICAvLyBMaW1pdCBmb3IgcGVyZm9ybWFuY2VcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb25zdCBqYWNTaW0gPSBTaW1pbGFyaXR5U2NvcmVyLmphY2NhcmRTaW1pbGFyaXR5KGludGVyZXN0VG9rZW5zLCBhcnRpY2xlVG9rZW5zKTtcbiAgICAgICAgICAgIGNvbnN0IHRva1NpbSA9IFNpbWlsYXJpdHlTY29yZXIudG9rZW5PdmVybGFwKGludGVyZXN0VG9rZW5zLCBhcnRpY2xlVG9rZW5zKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc29sZS5sb2coYFNpbWlsYXJpdHkgbWV0cmljcyBicmVha2Rvd246XG4gIC0gTGV2ZW5zaHRlaW4gc2ltaWxhcml0eTogJHtsZXZTaW0udG9GaXhlZCgyKX0lXG4gIC0gSmFjY2FyZCBzaW1pbGFyaXR5OiAgICAgJHtqYWNTaW0udG9GaXhlZCgyKX0lXG4gIC0gVG9rZW4gb3ZlcmxhcDogICAgICAgICAgJHt0b2tTaW0udG9GaXhlZCgyKX0lYCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgRW1wdHkgYXJ0aWNsZSBjb250ZW50IC0gU2ltaWxhcml0eSBzY29yZTogMCAvIDYwIHBvaW50c2ApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZyhgXFxuLS0tLS0gU0NPUklORyBDT01QT05FTlQgMjogQ09OVEVYVFVBTCBSRUxFVkFOQ0UgKDAtMzAgcG9pbnRzKSAtLS0tLWApO1xuICAgICAgICAvLyAtLS0tIDIuIENPTlRFWFRVQUwgUkVMRVZBTkNFICgwLTMwIHBvaW50cykgLS0tLVxuICAgICAgICBsZXQgY29udGV4dHVhbFNjb3JlID0gMDtcbiAgICAgICAgXG4gICAgICAgIC8vIFRpdGxlIHdlaWdodCBpcyBoaWdoZXIgaWYgdXNlciBpbnRlcmVzdHMgYXBwZWFyIGluIHRoZSB0aXRsZVxuICAgICAgICBjb25zdCB0aXRsZUltcG9ydGFuY2UgPSB1c2VySW50ZXJlc3RzLnNwbGl0KC9cXHMrLykuc29tZSh0ZXJtID0+IFxuICAgICAgICAgICAgYXJ0aWNsZS50aXRsZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHRlcm0udG9Mb3dlckNhc2UoKSlcbiAgICAgICAgKSA/IDIuMCA6IDEuMDtcbiAgICAgICAgXG4gICAgICAgIGlmICh0aXRsZUltcG9ydGFuY2UgPiAxLjApIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBJbnRlcmVzdCB0ZXJtcyBmb3VuZCBpbiB0aXRsZTogYXBwbHlpbmcgJHt0aXRsZUltcG9ydGFuY2V9eCB0aXRsZSBpbXBvcnRhbmNlIG11bHRpcGxpZXJgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQ2FsY3VsYXRlIHNlbWFudGljIHNpbWlsYXJpdHkgYmFzZWQgb24ga2V5IHBhcnRzIHdpdGggZGlmZmVyZW50IHdlaWdodHNcbiAgICAgICAgY29uc3QgdGl0bGVTaW1pbGFyaXR5ID0gU2ltaWxhcml0eVNjb3Jlci5jb21wdXRlKHVzZXJJbnRlcmVzdHMsIHRpdGxlVGV4dCkgKiB0aXRsZUltcG9ydGFuY2U7XG4gICAgICAgIGNvbnNvbGUubG9nKGBUaXRsZSBzaW1pbGFyaXR5OiAkeyh0aXRsZVNpbWlsYXJpdHkgLyB0aXRsZUltcG9ydGFuY2UpLnRvRml4ZWQoMil9JSAocmF3KSDDlyAke3RpdGxlSW1wb3J0YW5jZX0gPSAke3RpdGxlU2ltaWxhcml0eS50b0ZpeGVkKDIpfSVgKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHN1YmplY3RTaW1pbGFyaXR5ID0gc3ViamVjdFRleHQgPyBcbiAgICAgICAgICAgIFNpbWlsYXJpdHlTY29yZXIuY29tcHV0ZSh1c2VySW50ZXJlc3RzLCBzdWJqZWN0VGV4dCkgOiAwO1xuICAgICAgICBjb25zb2xlLmxvZyhgU3ViamVjdCBzaW1pbGFyaXR5OiAke3N1YmplY3RTaW1pbGFyaXR5LnRvRml4ZWQoMil9JWApO1xuICAgICAgICBcbiAgICAgICAgLy8gV2VpZ2h0ZWQgYXZlcmFnZSBvZiB0aXRsZSBhbmQgc3ViamVjdCBzaW1pbGFyaXRpZXNcbiAgICAgICAgY29uc3Qgd2VpZ2h0ZWRDb250ZXh0U2ltaWxhcml0eSA9ICh0aXRsZVNpbWlsYXJpdHkgKiAwLjcpICsgKHN1YmplY3RTaW1pbGFyaXR5ICogMC4zKTtcbiAgICAgICAgY29uc29sZS5sb2coYFdlaWdodGVkIGNvbnRleHQgc2ltaWxhcml0eTogJHt3ZWlnaHRlZENvbnRleHRTaW1pbGFyaXR5LnRvRml4ZWQoMil9JWApO1xuICAgICAgICBcbiAgICAgICAgLy8gU2NhbGUgdG8gdGhlIDMwLXBvaW50IHNjb3JpbmcgY29tcG9uZW50XG4gICAgICAgIGNvbnRleHR1YWxTY29yZSA9ICh3ZWlnaHRlZENvbnRleHRTaW1pbGFyaXR5IC8gMTAwKSAqIDMwO1xuICAgICAgICBjb25zb2xlLmxvZyhgQ29udGV4dHVhbCByZWxldmFuY2Ugc2NvcmU6ICR7Y29udGV4dHVhbFNjb3JlLnRvRml4ZWQoMil9IC8gMzAgcG9pbnRzYCk7XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZyhgXFxuLS0tLS0gU0NPUklORyBDT01QT05FTlQgMzogRlJFU0hORVNTICYgVU5JUVVFTkVTUyAoMC0xMCBwb2ludHMpIC0tLS0tYCk7XG4gICAgICAgIC8vIC0tLS0gMy4gRlJFU0hORVNTIEZBQ1RPUiBXSVRIIFVOSVFVRU5FU1MgKDAtMTAgcG9pbnRzKSAtLS0tXG4gICAgICAgIGxldCBmcmVzaG5lc3NTY29yZSA9IDA7XG4gICAgICAgIFxuICAgICAgICAvLyBCYXNlIGZyZXNobmVzcyBzY29yZSBmcm9tIGFydGljbGUgSUQgKGNvbnNpc3RlbnQgdmFsdWUpXG4gICAgICAgIGNvbnN0IGJhc2VGcmVzaG5lc3MgPSBhcnRpY2xlLmlkID8gXG4gICAgICAgICAgICAocGFyc2VJbnQoYXJ0aWNsZS5pZC5yZXBsYWNlKC9cXEQvZywgJycpLnNsaWNlKC0yKSB8fCAnMCcpICUgOCkgOiBcbiAgICAgICAgICAgIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDgpO1xuICAgICAgICBcbiAgICAgICAgY29uc29sZS5sb2coYEJhc2UgZnJlc2huZXNzOiAke2Jhc2VGcmVzaG5lc3N9IC8gOGApO1xuICAgICAgICBcbiAgICAgICAgLy8gVW5pcXVlbmVzcyBib251czogaWYgYXJ0aWNsZSB0aXRsZSBjb250YWlucyB1bmNvbW1vbiB3b3JkcyBjb21wYXJlZCB0byBvdGhlciBhcnRpY2xlc1xuICAgICAgICBjb25zdCBhbGxUaXRsZXMgPSBhcnRpY2xlQ29sbGVjdGlvbi5tYXAoYSA9PiBhLnRpdGxlLnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICBjb25zdCB0aXRsZVdvcmRzID0gdGl0bGVUZXh0LnRvTG93ZXJDYXNlKCkuc3BsaXQoL1xccysvKS5maWx0ZXIodyA9PiB3Lmxlbmd0aCA+IDQpOyAvLyBPbmx5IGNvbnNpZGVyIHN1YnN0YW50aWFsIHdvcmRzXG4gICAgICAgIFxuICAgICAgICBsZXQgdW5jb21tb25Xb3JkQ291bnQgPSAwO1xuICAgICAgICB0aXRsZVdvcmRzLmZvckVhY2god29yZCA9PiB7XG4gICAgICAgICAgICAvLyBDb3VudCBob3cgbWFueSBvdGhlciBhcnRpY2xlcyBjb250YWluIHRoaXMgd29yZFxuICAgICAgICAgICAgY29uc3Qgb2NjdXJyZW5jZUNvdW50ID0gYWxsVGl0bGVzLmZpbHRlcih0ID0+IHQuaW5jbHVkZXMod29yZCkpLmxlbmd0aDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gSWYgd29yZCBhcHBlYXJzIGluIGxlc3MgdGhhbiAyMCUgb2YgYXJ0aWNsZXMsIGNvbnNpZGVyIGl0IHVuY29tbW9uXG4gICAgICAgICAgICBpZiAob2NjdXJyZW5jZUNvdW50IDw9IE1hdGgubWF4KDEsIE1hdGguZmxvb3IoYXJ0aWNsZUNvbGxlY3Rpb24ubGVuZ3RoICogMC4yKSkpIHtcbiAgICAgICAgICAgICAgICB1bmNvbW1vbldvcmRDb3VudCsrO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGAgIFVuY29tbW9uIHdvcmQgZm91bmQ6IFwiJHt3b3JkfVwiIChpbiAke29jY3VycmVuY2VDb3VudH0gYXJ0aWNsZXMpYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2FsY3VsYXRlIHVuaXF1ZW5lc3MgYm9udXMgKG1heCArMiBwb2ludHMpXG4gICAgICAgIGNvbnN0IHVuaXF1ZW5lc3NCb251cyA9IE1hdGgubWluKDIsIHVuY29tbW9uV29yZENvdW50ICogMC41KTtcbiAgICAgICAgY29uc29sZS5sb2coYFVuaXF1ZW5lc3MgYm9udXM6ICR7dW5pcXVlbmVzc0JvbnVzLnRvRml4ZWQoMil9IHBvaW50cyAoJHt1bmNvbW1vbldvcmRDb3VudH0gdW5jb21tb24gd29yZHMpYCk7XG4gICAgICAgIFxuICAgICAgICAvLyBDb21iaW5lIGJhc2UgZnJlc2huZXNzIHdpdGggdW5pcXVlbmVzcyBib251c1xuICAgICAgICBmcmVzaG5lc3NTY29yZSA9IGJhc2VGcmVzaG5lc3MgKyB1bmlxdWVuZXNzQm9udXM7XG4gICAgICAgIGNvbnNvbGUubG9nKGBGcmVzaG5lc3MgJiB1bmlxdWVuZXNzIHNjb3JlOiAke2ZyZXNobmVzc1Njb3JlLnRvRml4ZWQoMil9IC8gMTAgcG9pbnRzYCk7XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZyhgXFxuLS0tLS0gRklOQUwgU0NPUkUgQ0FMQ1VMQVRJT04gLS0tLS1gKTtcbiAgICAgICAgLy8gLS0tLSBDT01CSU5FIFNDT1JFUyAtLS0tXG4gICAgICAgIGNvbnN0IGZpbmFsU2NvcmUgPSBzaW1pbGFyaXR5U2NvcmUgKyBjb250ZXh0dWFsU2NvcmUgKyBmcmVzaG5lc3NTY29yZTtcbiAgICAgICAgY29uc29sZS5sb2coYEZpbmFsIHNjb3JlIGJyZWFrZG93bjpcbiAgLSBUZXh0IFNpbWlsYXJpdHk6ICAgICAgICAgJHtzaW1pbGFyaXR5U2NvcmUudG9GaXhlZCgyKX0gLyA2MFxuICAtIENvbnRleHR1YWwgUmVsZXZhbmNlOiAgICAke2NvbnRleHR1YWxTY29yZS50b0ZpeGVkKDIpfSAvIDMwXG4gIC0gRnJlc2huZXNzICYgVW5pcXVlbmVzczogICR7ZnJlc2huZXNzU2NvcmUudG9GaXhlZCgyKX0gLyAxMFxuICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIFRPVEFMIFNDT1JFOiAgICAgICAgICAgICAgICR7ZmluYWxTY29yZS50b0ZpeGVkKDIpfSAvIDEwMFxuYCk7XG4gICAgICAgIFxuICAgICAgICAvLyBMb2cgYWxsIHNjb3JpbmcgY29tcG9uZW50c1xuICAgICAgICBjb25zdCBzY29yZUJyZWFrZG93biA9IHtcbiAgICAgICAgICAgIHNpbWlsYXJpdHk6IHNpbWlsYXJpdHlTY29yZS50b0ZpeGVkKDIpLFxuICAgICAgICAgICAgY29udGV4dHVhbDogY29udGV4dHVhbFNjb3JlLnRvRml4ZWQoMiksXG4gICAgICAgICAgICBmcmVzaG5lc3M6IGZyZXNobmVzc1Njb3JlLnRvRml4ZWQoMiksXG4gICAgICAgICAgICBmaW5hbDogZmluYWxTY29yZS50b0ZpeGVkKDIpXG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZyhgU2NvcmUgY29tcG9uZW50cyBzdG9yZWQ6YCwgc2NvcmVCcmVha2Rvd24pO1xuICAgICAgICBcbiAgICAgICAgLy8gU3RvcmUgc2NvcmUgY29tcG9uZW50cyBpbiB0aGUgYXJ0aWNsZSBvYmplY3QgZm9yIGRpc3BsYXlcbiAgICAgICAgYXJ0aWNsZS5zY29yZUNvbXBvbmVudHMgPSBzY29yZUJyZWFrZG93bjtcbiAgICAgICAgXG4gICAgICAgIGNvbnNvbGUubG9nKGBcXG4tLS0tLSBTQ09SSU5HIENPTVBMRVRFIC0tLS0tYCk7XG4gICAgICAgIFxuICAgICAgICAvLyBFbnN1cmUgc2NvcmUgaXMgYmV0d2VlbiAwLTEwMFxuICAgICAgICByZXR1cm4gTWF0aC5taW4oMTAwLCBNYXRoLm1heCgwLCBmaW5hbFNjb3JlKSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRVJST1IgSU4gUkFOS0lORyBTWVNURU06JywgZXJyb3IpO1xuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMjUpICsgNzA7IC8vIEZhbGxiYWNrIHNjb3JlXG4gICAgfVxufTtcblxuLy8gQVBJIFNlcnZpY2VcbmNsYXNzIEFwaVNlcnZpY2Uge1xuICAgIHByaXZhdGUgYmFzZVVybDogc3RyaW5nID0gJyc7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgLy8gSW4gZGV2ZWxvcG1lbnQsIHVzZSBhIGRpZmZlcmVudCBiYXNlIFVSTFxuICAgICAgICB0aGlzLmJhc2VVcmwgPSB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUgPT09ICdsb2NhbGhvc3QnIFxuICAgICAgICAgICAgPyAnaHR0cDovL2xvY2FsaG9zdDozMDAwJyBcbiAgICAgICAgICAgIDogJyc7XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZyhgQXBpU2VydmljZSBpbml0aWFsaXplZCB3aXRoIGJhc2VVcmw6ICR7dGhpcy5iYXNlVXJsfWApO1xuICAgICAgICBjb25zb2xlLmxvZyhgQ3VycmVudCBob3N0bmFtZTogJHt3aW5kb3cubG9jYXRpb24uaG9zdG5hbWV9YCk7XG4gICAgfVxuXG4gICAgYXN5bmMgZ2V0QXJ0aWNsZXMoaW50ZXJlc3RzPzogc3RyaW5nKTogUHJvbWlzZTxBcnRpY2xlW10+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHF1ZXJ5UGFyYW1zID0gaW50ZXJlc3RzID8gYD9pbnRlcmVzdHM9JHtlbmNvZGVVUklDb21wb25lbnQoaW50ZXJlc3RzKX1gIDogJyc7XG4gICAgICAgICAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmJhc2VVcmx9L2FwaS9hcnRpY2xlcyR7cXVlcnlQYXJhbXN9YDtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBGZXRjaGluZyBhcnRpY2xlcyBmcm9tOiAke3VybH1gKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgcmVzcG9uc2UgZnJvbSBzZXJ2ZXI6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGZldGNoIGFydGljbGVzOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgQXJ0aWNsZXMgZmV0Y2hlZCBzdWNjZXNzZnVsbHkuIENvdW50OiAke2RhdGEubGVuZ3RofWApO1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFNhbXBsZSBhcnRpY2xlIGRhdGE6YCwgZGF0YS5sZW5ndGggPiAwID8gZGF0YVswXSA6ICdObyBhcnRpY2xlcycpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBFbnN1cmUgZWFjaCBhcnRpY2xlIGhhcyB0aGUgZXhwZWN0ZWQgZm9ybWF0IGFuZCBwcm9wZXJ0aWVzXG4gICAgICAgICAgICBjb25zdCBmb3JtYXR0ZWRBcnRpY2xlcyA9IGRhdGEubWFwKChhcnRpY2xlOiBhbnkpID0+ICh7XG4gICAgICAgICAgICAgICAgaWQ6IGFydGljbGUuaWQgfHwgJycsIC8vIFByZXNlcnZlIElEIGZyb20gQVBJIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgdGl0bGU6IGFydGljbGUudGl0bGUgfHwgJ1VudGl0bGVkIEFydGljbGUnLFxuICAgICAgICAgICAgICAgIHN1YmplY3Q6IGFydGljbGUuc3ViamVjdCB8fCAnJyxcbiAgICAgICAgICAgICAgICBsaW5rOiBhcnRpY2xlLmxpbmsgfHwgJycsXG4gICAgICAgICAgICAgICAgc2NvcmU6IGFydGljbGUuc2NvcmUgfHwgMCxcbiAgICAgICAgICAgICAgICBzdW1tYXJ5OiBhcnRpY2xlLnN1bW1hcnkgfHwgJydcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIGZvcm1hdHRlZEFydGljbGVzO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYXJ0aWNsZXM6JywgZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgZ2V0QXJ0aWNsZURldGFpbHMoYXJ0aWNsZUlkOiBzdHJpbmcpOiBQcm9taXNlPEFydGljbGVEZXRhaWwgfCBudWxsPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmJhc2VVcmx9L2FwaS9hcnRpY2xlLyR7YXJ0aWNsZUlkfWA7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgRmV0Y2hpbmcgYXJ0aWNsZSBkZXRhaWxzIGZyb206ICR7dXJsfWApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciByZXNwb25zZSBmcm9tIHNlcnZlcjogJHtyZXNwb25zZS5zdGF0dXN9YCk7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggYXJ0aWNsZSBkZXRhaWxzOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnQXJ0aWNsZSBkZXRhaWxzIHJlc3BvbnNlOicsIGRhdGEpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBJZiB3ZSBnZXQgYSBwcm9wZXIgcmVzcG9uc2Ugd2l0aCBhcnRpY2xlIGRhdGFcbiAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PT0gJ3N1Y2Nlc3MnICYmIGRhdGEuYXJ0aWNsZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdBcnRpY2xlIGRldGFpbHMgZmV0Y2hlZCBzdWNjZXNzZnVsbHk6JywgZGF0YS5hcnRpY2xlLnRpdGxlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZGF0YS5hcnRpY2xlLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICBsaW5rOiBkYXRhLmFydGljbGUubGluayxcbiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogZGF0YS5hcnRpY2xlLnN1bW1hcnksXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGRhdGEuYXJ0aWNsZS5jb250ZW50XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignSW52YWxpZCBhcnRpY2xlIGRhdGEgZm9ybWF0OicsIGRhdGEpO1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYXJ0aWNsZSBkZXRhaWxzOicsIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgYW5hbHl6ZUludGVyZXN0cyhpbnRlcmVzdHM6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3RoaXMuYmFzZVVybH0vYXBpL2FuYWx5emUtaW50ZXJlc3RzYCwge1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBpbnRlcmVzdHMgfSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gYW5hbHl6ZSBpbnRlcmVzdHMnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGFuYWx5emluZyBpbnRlcmVzdHM6JywgZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8vIFVJIENvbnRyb2xsZXJcbmNsYXNzIEFwcENvbnRyb2xsZXIge1xuICAgIHByaXZhdGUgYXBpU2VydmljZTogQXBpU2VydmljZTtcbiAgICBwcml2YXRlIGFydGljbGVzQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGw7XG4gICAgcHJpdmF0ZSBpbnRlcmVzdHNJbnB1dDogSFRNTElucHV0RWxlbWVudCB8IG51bGw7XG4gICAgcHJpdmF0ZSBzdWJtaXRCdXR0b246IEhUTUxFbGVtZW50IHwgbnVsbDtcbiAgICBcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5hcGlTZXJ2aWNlID0gbmV3IEFwaVNlcnZpY2UoKTtcbiAgICAgICAgdGhpcy5hcnRpY2xlc0NvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcnRpY2xlcy1jb250YWluZXInKTtcbiAgICAgICAgdGhpcy5pbnRlcmVzdHNJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnRlcmVzdHMtaW5wdXQnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICB0aGlzLnN1Ym1pdEJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdWJtaXQtaW50ZXJlc3RzJyk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLmluaXRFdmVudExpc3RlbmVycygpO1xuICAgICAgICB0aGlzLmxvYWRBcnRpY2xlcygpO1xuICAgIH1cbiAgICBcbiAgICBwcml2YXRlIGluaXRFdmVudExpc3RlbmVycygpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuc3VibWl0QnV0dG9uKSB7XG4gICAgICAgICAgICB0aGlzLnN1Ym1pdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuaGFuZGxlSW50ZXJlc3RzU3VibWl0KCkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIHByaXZhdGUgYXN5bmMgbG9hZEFydGljbGVzKGludGVyZXN0cz86IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAoIXRoaXMuYXJ0aWNsZXNDb250YWluZXIpIHJldHVybjtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYExvYWRpbmcgYXJ0aWNsZXMgd2l0aCBpbnRlcmVzdHM6ICR7aW50ZXJlc3RzIHx8ICdub25lJ31gKTtcbiAgICAgICAgICAgIHRoaXMuYXJ0aWNsZXNDb250YWluZXIuaW5uZXJIVE1MID0gJzxkaXYgY2xhc3M9XCJsb2FkaW5nXCI+TG9hZGluZyBhcnRpY2xlcy4uLjwvZGl2Pic7XG4gICAgICAgICAgICBjb25zdCBhcnRpY2xlcyA9IGF3YWl0IHRoaXMuYXBpU2VydmljZS5nZXRBcnRpY2xlcyhpbnRlcmVzdHMpO1xuICAgICAgICAgICAgaWYgKGFydGljbGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYXJ0aWNsZXNDb250YWluZXIuaW5uZXJIVE1MID0gJzxkaXYgY2xhc3M9XCJtZXNzYWdlXCI+Tm8gYXJ0aWNsZXMgZm91bmQuIFBsZWFzZSB0cnkgd2l0aCBkaWZmZXJlbnQgaW50ZXJlc3RzLjwvZGl2Pic7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc29sZS5sb2coYEZldGNoZWQgJHthcnRpY2xlcy5sZW5ndGh9IGFydGljbGVzLCBub3cgc2NvcmluZyBiYXNlZCBvbiBpbnRlcmVzdHM6ICR7aW50ZXJlc3RzIHx8ICdub25lJ31gKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gRGVkdXBsaWNhdGUgYXJ0aWNsZXMgYnkgdGl0bGVcbiAgICAgICAgICAgIGNvbnN0IHVuaXF1ZUFydGljbGVzID0gdGhpcy5kZWR1cGxpY2F0ZUFydGljbGVzKGFydGljbGVzKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBSZWR1Y2VkIHRvICR7dW5pcXVlQXJ0aWNsZXMubGVuZ3RofSB1bmlxdWUgYXJ0aWNsZXMgYWZ0ZXIgZGVkdXBsaWNhdGlvbmApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBTY29yZSBhbGwgYXJ0aWNsZXMgdXNpbmcgdGhlIGN1c3RvbSByYW5raW5nIHN5c3RlbVxuICAgICAgICAgICAgY29uc3Qgc2NvcmluZ1Byb21pc2VzID0gdW5pcXVlQXJ0aWNsZXMubWFwKGFydGljbGUgPT4gXG4gICAgICAgICAgICAgICAgY3VzdG9tUmFua2luZ1N5c3RlbShhcnRpY2xlLCBpbnRlcmVzdHMgfHwgJycsIHVuaXF1ZUFydGljbGVzKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3Qgc2NvcmVzID0gYXdhaXQgUHJvbWlzZS5hbGwoc2NvcmluZ1Byb21pc2VzKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQXBwbHkgc2NvcmVzIHRvIGFydGljbGVzXG4gICAgICAgICAgICBjb25zdCBzY29yZWRBcnRpY2xlcyA9IHVuaXF1ZUFydGljbGVzLm1hcCgoYXJ0aWNsZSwgaW5kZXgpID0+ICh7XG4gICAgICAgICAgICAgICAgLi4uYXJ0aWNsZSxcbiAgICAgICAgICAgICAgICBzY29yZTogTWF0aC5yb3VuZChzY29yZXNbaW5kZXhdKSAvLyBSb3VuZCB0byBuZWFyZXN0IGludGVnZXIgZm9yIGRpc3BsYXlcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc29sZS5sb2coYFNjb3JlZCAke3Njb3JlZEFydGljbGVzLmxlbmd0aH0gYXJ0aWNsZXMgdXNpbmcgY3VzdG9tIHJhbmtpbmcgc3lzdGVtYCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFNvcnQgYnkgc2NvcmUgKGhpZ2hlc3QgZmlyc3QpXG4gICAgICAgICAgICBzY29yZWRBcnRpY2xlcy5zb3J0KChhLCBiKSA9PiBiLnNjb3JlIC0gYS5zY29yZSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkFydGljbGVzIHNvcnRlZCBieSBzY29yZVwiKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5yZW5kZXJBcnRpY2xlcyhzY29yZWRBcnRpY2xlcyk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsb2FkaW5nIGFydGljbGVzOicsIGVycm9yKTtcbiAgICAgICAgICAgIHRoaXMuYXJ0aWNsZXNDb250YWluZXIuaW5uZXJIVE1MID0gJzxkaXYgY2xhc3M9XCJlcnJvclwiPkVycm9yIGxvYWRpbmcgYXJ0aWNsZXMuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuPC9kaXY+JztcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBIZWxwZXIgbWV0aG9kIHRvIGRlZHVwbGljYXRlIGFydGljbGVzIGJhc2VkIG9uIHRpdGxlXG4gICAgcHJpdmF0ZSBkZWR1cGxpY2F0ZUFydGljbGVzKGFydGljbGVzOiBBcnRpY2xlW10pOiBBcnRpY2xlW10ge1xuICAgICAgICBjb25zdCB1bmlxdWVUaXRsZXMgPSBuZXcgU2V0PHN0cmluZz4oKTtcbiAgICAgICAgcmV0dXJuIGFydGljbGVzLmZpbHRlcihhcnRpY2xlID0+IHtcbiAgICAgICAgICAgIC8vIE5vcm1hbGl6ZSB0aXRsZSBmb3IgY29tcGFyaXNvblxuICAgICAgICAgICAgY29uc3Qgbm9ybWFsaXplZFRpdGxlID0gYXJ0aWNsZS50aXRsZS50b0xvd2VyQ2FzZSgpLnRyaW0oKTtcbiAgICAgICAgICAgIGlmICh1bmlxdWVUaXRsZXMuaGFzKG5vcm1hbGl6ZWRUaXRsZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7IC8vIFNraXAgZHVwbGljYXRlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB1bmlxdWVUaXRsZXMuYWRkKG5vcm1hbGl6ZWRUaXRsZSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIHByaXZhdGUgcmVuZGVyQXJ0aWNsZXMoYXJ0aWNsZXM6IEFydGljbGVbXSk6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMuYXJ0aWNsZXNDb250YWluZXIpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGNvbnNvbGUubG9nKGBSZW5kZXJpbmcgJHthcnRpY2xlcy5sZW5ndGh9IGFydGljbGVzYCk7XG4gICAgICAgIHRoaXMuYXJ0aWNsZXNDb250YWluZXIuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgIFxuICAgICAgICAvLyBDcmVhdGUgYSBjb250YWluZXIgZm9yIHRoZSBhcnRpY2xlIGNhcmRzIHRoYXQgdXNlcyBDU1MgZ3JpZFxuICAgICAgICBjb25zdCBhcnRpY2xlc0dyaWQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgYXJ0aWNsZXNHcmlkLmNsYXNzTmFtZSA9ICdhcnRpY2xlcy1ncmlkJztcbiAgICAgICAgYXJ0aWNsZXNHcmlkLnN0eWxlLmRpc3BsYXkgPSAnZ3JpZCc7XG4gICAgICAgIGFydGljbGVzR3JpZC5zdHlsZS5ncmlkVGVtcGxhdGVDb2x1bW5zID0gJ3JlcGVhdChhdXRvLWZpbGwsIG1pbm1heCgzMDBweCwgMWZyKSknO1xuICAgICAgICBhcnRpY2xlc0dyaWQuc3R5bGUuZ2FwID0gJzIwcHgnO1xuICAgICAgICBhcnRpY2xlc0dyaWQuc3R5bGUucGFkZGluZyA9ICcxMHB4JztcbiAgICAgICAgXG4gICAgICAgIGFydGljbGVzLmZvckVhY2goYXJ0aWNsZSA9PiB7XG4gICAgICAgICAgICAvLyBFeHRyYWN0IGFydGljbGUgSUQgZnJvbSBsaW5rIC0gVXNlIGFydGljbGUuaWQgaWYgYXZhaWxhYmxlLCBvdGhlcndpc2UgZXh0cmFjdCBmcm9tIGxpbmtcbiAgICAgICAgICAgIGxldCBhcnRpY2xlSWQ7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBhcnRpY2xlIGFscmVhZHkgaGFzIGFuIGlkIHByb3BlcnR5XG4gICAgICAgICAgICBpZiAoJ2lkJyBpbiBhcnRpY2xlICYmIGFydGljbGUuaWQpIHtcbiAgICAgICAgICAgICAgICBhcnRpY2xlSWQgPSBhcnRpY2xlLmlkO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBFeHRyYWN0IGZyb20gbGluayAtIG1ha2luZyB0aGlzIG1vcmUgcm9idXN0XG4gICAgICAgICAgICAgICAgY29uc3QgbGlua1BhcnRzID0gYXJ0aWNsZS5saW5rLnNwbGl0KCcvJyk7XG4gICAgICAgICAgICAgICAgYXJ0aWNsZUlkID0gbGlua1BhcnRzW2xpbmtQYXJ0cy5sZW5ndGggLSAxXTsgLy8gR2V0IHRoZSBsYXN0IHBhcnQgb2YgdGhlIGxpbmtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgbGluayBkb2Vzbid0IGNvbnRhaW4gYSB2YWxpZCBJRCwgZ2VuZXJhdGUgb25lIGZyb20gdGhlIHRpdGxlXG4gICAgICAgICAgICAgICAgaWYgKCFhcnRpY2xlSWQgfHwgYXJ0aWNsZUlkID09PSAnIycpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gTWFrZSBhIHNsdWcgZnJvbSB0aXRsZSArIHJhbmRvbSBudW1iZXJzIHRvIGVuc3VyZSB1bmlxdWVuZXNzXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRpdGxlU2x1ZyA9IGFydGljbGUudGl0bGVcbiAgICAgICAgICAgICAgICAgICAgICAgIC50b0xvd2VyQ2FzZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvW15hLXowLTldKy9nLCAnLScpXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvKF4tfC0kKS9nLCAnJyk7XG4gICAgICAgICAgICAgICAgICAgIGFydGljbGVJZCA9IGAke3RpdGxlU2x1Z30tJHtEYXRlLm5vdygpLnRvU3RyaW5nKCkuc2xpY2UoLTYpfWA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgUmVuZGVyaW5nIGFydGljbGU6IFwiJHthcnRpY2xlLnRpdGxlfVwiIChJRDogJHthcnRpY2xlSWR9KWApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBQcmVwYXJlIHN1bW1hcnkgdGV4dFxuICAgICAgICAgICAgbGV0IHN1bW1hcnlUZXh0ID0gYXJ0aWNsZS5zdW1tYXJ5IHx8ICcnO1xuICAgICAgICAgICAgaWYgKCFzdW1tYXJ5VGV4dCB8fCBzdW1tYXJ5VGV4dC50cmltKCkgPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgc3VtbWFyeVRleHQgPSBhcnRpY2xlLnN1YmplY3QgfHwgJ05vIGludHJvZHVjdGlvbiBhdmFpbGFibGUnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBGb3JtYXQgdGl0bGUgdG8gYmUgbW9yZSByZWFkYWJsZVxuICAgICAgICAgICAgbGV0IHRpdGxlID0gYXJ0aWNsZS50aXRsZTtcbiAgICAgICAgICAgIGlmICh0aXRsZS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoJ2RlZXAgZGl2ZTonKSkge1xuICAgICAgICAgICAgICAgIHRpdGxlID0gdGl0bGUucmVwbGFjZSgvXmRlZXAgZGl2ZTovaSwgJycpLnRyaW0oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgYXJ0aWNsZUNhcmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGFydGljbGVDYXJkLmNsYXNzTmFtZSA9ICdhcnRpY2xlLWNhcmQnO1xuICAgICAgICAgICAgYXJ0aWNsZUNhcmQuc3R5bGUuYm9yZGVyID0gJzFweCBzb2xpZCAjZTBlMGUwJztcbiAgICAgICAgICAgIGFydGljbGVDYXJkLnN0eWxlLmJvcmRlclJhZGl1cyA9ICc4cHgnO1xuICAgICAgICAgICAgYXJ0aWNsZUNhcmQuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcbiAgICAgICAgICAgIGFydGljbGVDYXJkLnN0eWxlLmJveFNoYWRvdyA9ICcwIDRweCA2cHggcmdiYSgwLCAwLCAwLCAwLjEpJztcbiAgICAgICAgICAgIGFydGljbGVDYXJkLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcjZmZmZmZmJztcbiAgICAgICAgICAgIGFydGljbGVDYXJkLnN0eWxlLnRyYW5zaXRpb24gPSAndHJhbnNmb3JtIDAuMnMsIGJveC1zaGFkb3cgMC4ycyc7XG4gICAgICAgICAgICBhcnRpY2xlQ2FyZC5zdHlsZS5oZWlnaHQgPSAnMTAwJSc7XG4gICAgICAgICAgICBhcnRpY2xlQ2FyZC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xuICAgICAgICAgICAgYXJ0aWNsZUNhcmQuc3R5bGUuZmxleERpcmVjdGlvbiA9ICdjb2x1bW4nO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBIb3ZlciBlZmZlY3RcbiAgICAgICAgICAgIGFydGljbGVDYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXJ0aWNsZUNhcmQuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZVkoLTVweCknO1xuICAgICAgICAgICAgICAgIGFydGljbGVDYXJkLnN0eWxlLmJveFNoYWRvdyA9ICcwIDhweCAxNXB4IHJnYmEoMCwgMCwgMCwgMC4xKSc7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGFydGljbGVDYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXJ0aWNsZUNhcmQuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZVkoMCknO1xuICAgICAgICAgICAgICAgIGFydGljbGVDYXJkLnN0eWxlLmJveFNoYWRvdyA9ICcwIDRweCA2cHggcmdiYSgwLCAwLCAwLCAwLjEpJztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgYmFkZ2UgY29sb3IgYmFzZWQgb24gc2NvcmVcbiAgICAgICAgICAgIGNvbnN0IGdldEJhZGdlQ29sb3IgPSAoc2NvcmU6IG51bWJlcikgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChzY29yZSA+IDkwKSByZXR1cm4gJyM0Q0FGNTAnOyAvLyBHcmVlbiBmb3IgZXhjZWxsZW50XG4gICAgICAgICAgICAgICAgaWYgKHNjb3JlID4gNzUpIHJldHVybiAnIzIxOTZGMyc7IC8vIEJsdWUgZm9yIGdvb2RcbiAgICAgICAgICAgICAgICBpZiAoc2NvcmUgPiA2MCkgcmV0dXJuICcjRkY5ODAwJzsgLy8gT3JhbmdlIGZvciBtb2RlcmF0ZVxuICAgICAgICAgICAgICAgIHJldHVybiAnIzlFOUU5RSc7IC8vIEdyZXkgZm9yIGxvd1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgYmFkZ2VDb2xvciA9IGdldEJhZGdlQ29sb3IoYXJ0aWNsZS5zY29yZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGFydGljbGVDYXJkLmlubmVySFRNTCA9IGBcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYXJ0aWNsZS1oZWFkZXJcIiBzdHlsZT1cInBhZGRpbmc6IDE1cHg7IHBvc2l0aW9uOiByZWxhdGl2ZTtcIj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT1cInBvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiAxNXB4OyByaWdodDogMTVweDsgYmFja2dyb3VuZC1jb2xvcjogJHtiYWRnZUNvbG9yfTsgY29sb3I6IHdoaXRlOyBwYWRkaW5nOiA1cHggMTBweDsgYm9yZGVyLXJhZGl1czogMTJweDsgZm9udC13ZWlnaHQ6IGJvbGQ7IGZvbnQtc2l6ZTogMTRweDtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICR7YXJ0aWNsZS5zY29yZX1cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxoMyBjbGFzcz1cImFydGljbGUtdGl0bGVcIiBzdHlsZT1cIm1hcmdpbi10b3A6IDA7IG1hcmdpbi1ib3R0b206IDEwcHg7IGZvbnQtc2l6ZTogMThweDsgY29sb3I6ICMzMzM7IHBhZGRpbmctcmlnaHQ6IDYwcHg7XCI+JHt0aGlzLmVzY2FwZUh0bWwodGl0bGUpfTwvaDM+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJhcnRpY2xlLXN1YmplY3RcIiBzdHlsZT1cImZvbnQtc2l6ZTogMTRweDsgY29sb3I6ICM2NjY7IG1hcmdpbi1ib3R0b206IDE1cHg7XCI+JHt0aGlzLmVzY2FwZUh0bWwoYXJ0aWNsZS5zdWJqZWN0IHx8ICcnKX08L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInNjb3JlLWJyZWFrZG93blwiIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogI2Y5ZjlmOTsgYm9yZGVyLXJhZGl1czogNXB4OyBwYWRkaW5nOiAxMHB4OyBtYXJnaW4tdG9wOiAxMHB4OyBkaXNwbGF5OiBub25lO1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT1cIm1hcmdpbi1ib3R0b206IDhweDtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPVwiaGVpZ2h0OiA2cHg7IGJhY2tncm91bmQtY29sb3I6ICNlMGUwZTA7IGJvcmRlci1yYWRpdXM6IDNweDsgb3ZlcmZsb3c6IGhpZGRlbjtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT1cImhlaWdodDogMTAwJTsgd2lkdGg6ICR7TWF0aC5taW4oMTAwLCBhcnRpY2xlLnNjb3JlKX0lOyBiYWNrZ3JvdW5kLWNvbG9yOiAke2JhZGdlQ29sb3J9O1wiPjwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAke2FydGljbGUuc2NvcmVDb21wb25lbnRzID8gYFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT1cImZvbnQtc2l6ZTogMTJweDsgY29sb3I6ICM1NTU7XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT1cImRpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsgbWFyZ2luLWJvdHRvbTogMnB4O1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5LZXl3b3Jkczo8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPiR7YXJ0aWNsZS5zY29yZUNvbXBvbmVudHMuc2ltaWxhcml0eX0vNjA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT1cImRpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsgbWFyZ2luLWJvdHRvbTogMnB4O1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5Db250ZXh0dWFsOjwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+JHthcnRpY2xlLnNjb3JlQ29tcG9uZW50cy5jb250ZXh0dWFsfS8zMDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPVwiZGlzcGxheTogZmxleDsganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5GcmVzaG5lc3M6PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj4ke2FydGljbGUuc2NvcmVDb21wb25lbnRzLmZyZXNobmVzc30vMTA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gIDogJyd9XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPVwidGV4dC1hbGlnbjogY2VudGVyOyBtYXJnaW4tdG9wOiA1cHg7IGZvbnQtc2l6ZTogMTJweDsgY29sb3I6ICM4ODg7IGN1cnNvcjogcG9pbnRlcjtcIiBjbGFzcz1cInRvZ2dsZS1kZXRhaWxzXCI+U2hvdyBsZXNzPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPVwidGV4dC1hbGlnbjogY2VudGVyOyBtYXJnaW4tdG9wOiA1cHg7IGZvbnQtc2l6ZTogMTJweDsgY29sb3I6ICM4ODg7IGN1cnNvcjogcG9pbnRlcjtcIiBjbGFzcz1cInRvZ2dsZS1kZXRhaWxzXCI+U2hvdyBzY29yZSBkZXRhaWxzPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImFydGljbGUtYm9keVwiIHN0eWxlPVwicGFkZGluZzogMTVweDsgYm9yZGVyLXRvcDogMXB4IHNvbGlkICNlZWVlZWU7IGZsZXgtZ3JvdzogMTsgZGlzcGxheTogZmxleDsgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcIj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImFydGljbGUtaW50cm9kdWN0aW9uXCIgc3R5bGU9XCJmbGV4LWdyb3c6IDE7XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8cCBzdHlsZT1cIm1hcmdpbi10b3A6IDA7IGxpbmUtaGVpZ2h0OiAxLjU7IGNvbG9yOiAjNDQ0OyBmb250LXNpemU6IDE0cHg7XCI+JHt0aGlzLnRydW5jYXRlVGV4dChzdW1tYXJ5VGV4dCwgMTUwKX08L3A+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8YSBocmVmPVwiI1wiIGNsYXNzPVwiYXJ0aWNsZS1saW5rXCIgZGF0YS1hcnRpY2xlLWlkPVwiJHthcnRpY2xlSWR9XCIgc3R5bGU9XCJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHBhZGRpbmc6IDhweCAxNXB4OyBiYWNrZ3JvdW5kLWNvbG9yOiAjMjE5NkYzOyBjb2xvcjogd2hpdGU7IHRleHQtZGVjb3JhdGlvbjogbm9uZTsgYm9yZGVyLXJhZGl1czogNHB4OyB0ZXh0LWFsaWduOiBjZW50ZXI7IG1hcmdpbi10b3A6IDE1cHg7IGZvbnQtd2VpZ2h0OiA1MDA7IHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycztcIj5SZWFkIG1vcmU8L2E+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICBgO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgY2xpY2sgZXZlbnQgdG8gdmlldyBhcnRpY2xlIGRldGFpbHNcbiAgICAgICAgICAgIGNvbnN0IGFydGljbGVMaW5rID0gYXJ0aWNsZUNhcmQucXVlcnlTZWxlY3RvcignLmFydGljbGUtbGluaycpIGFzIEhUTUxBbmNob3JFbGVtZW50O1xuICAgICAgICAgICAgaWYgKGFydGljbGVMaW5rKSB7XG4gICAgICAgICAgICAgICAgYXJ0aWNsZUxpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNsaWNrZWRJZCA9IGFydGljbGVMaW5rLmdldEF0dHJpYnV0ZSgnZGF0YS1hcnRpY2xlLWlkJyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjbGlja2VkSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmlld0FydGljbGVEZXRhaWxzKGNsaWNrZWRJZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdNaXNzaW5nIGFydGljbGUgSUQgaW4gZGF0YSBhdHRyaWJ1dGUnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgdG9nZ2xlIGZvciBzY29yZSBkZXRhaWxzXG4gICAgICAgICAgICBjb25zdCB0b2dnbGVFbGVtZW50cyA9IGFydGljbGVDYXJkLnF1ZXJ5U2VsZWN0b3JBbGwoJy50b2dnbGUtZGV0YWlscycpO1xuICAgICAgICAgICAgaWYgKHRvZ2dsZUVsZW1lbnRzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNob3dUb2dnbGUgPSB0b2dnbGVFbGVtZW50c1sxXSBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgICAgICAgICBjb25zdCBoaWRlVG9nZ2xlID0gdG9nZ2xlRWxlbWVudHNbMF0gYXMgSFRNTEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2NvcmVCcmVha2Rvd24gPSBhcnRpY2xlQ2FyZC5xdWVyeVNlbGVjdG9yKCcuc2NvcmUtYnJlYWtkb3duJykgYXMgSFRNTEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgc2hvd1RvZ2dsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgc2NvcmVCcmVha2Rvd24uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgICAgICAgICAgIHNob3dUb2dnbGUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBoaWRlVG9nZ2xlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzY29yZUJyZWFrZG93bi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgICAgICBzaG93VG9nZ2xlLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBhcnRpY2xlc0dyaWQuYXBwZW5kQ2hpbGQoYXJ0aWNsZUNhcmQpO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuYXJ0aWNsZXNDb250YWluZXIuYXBwZW5kQ2hpbGQoYXJ0aWNsZXNHcmlkKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBhIGRlYnVnIGNvdW50ZXJcbiAgICAgICAgY29uc3QgZGVidWdJbmZvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGRlYnVnSW5mby5jbGFzc05hbWUgPSAnZGVidWctaW5mbyc7XG4gICAgICAgIGRlYnVnSW5mby50ZXh0Q29udGVudCA9IGBEaXNwbGF5aW5nICR7YXJ0aWNsZXMubGVuZ3RofSB1bmlxdWUgYXJ0aWNsZXNgO1xuICAgICAgICBkZWJ1Z0luZm8uc3R5bGUudGV4dEFsaWduID0gJ2NlbnRlcic7XG4gICAgICAgIGRlYnVnSW5mby5zdHlsZS5tYXJnaW5Ub3AgPSAnMjBweCc7XG4gICAgICAgIGRlYnVnSW5mby5zdHlsZS5mb250U2l6ZSA9ICcxMnB4JztcbiAgICAgICAgZGVidWdJbmZvLnN0eWxlLmNvbG9yID0gJyM4ODgnO1xuICAgICAgICB0aGlzLmFydGljbGVzQ29udGFpbmVyLmFwcGVuZENoaWxkKGRlYnVnSW5mbyk7XG4gICAgfVxuICAgIFxuICAgIHByaXZhdGUgYXN5bmMgdmlld0FydGljbGVEZXRhaWxzKGFydGljbGVJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghdGhpcy5hcnRpY2xlc0NvbnRhaW5lcikgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5hcnRpY2xlc0NvbnRhaW5lci5pbm5lckhUTUwgPSAnPGRpdiBjbGFzcz1cImxvYWRpbmdcIj5Mb2FkaW5nIGFydGljbGUgZGV0YWlscy4uLjwvZGl2Pic7XG4gICAgICAgIFxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgYXJ0aWNsZURldGFpbCA9IGF3YWl0IHRoaXMuYXBpU2VydmljZS5nZXRBcnRpY2xlRGV0YWlscyhhcnRpY2xlSWQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoIWFydGljbGVEZXRhaWwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFydGljbGVzQ29udGFpbmVyLmlubmVySFRNTCA9ICc8ZGl2IGNsYXNzPVwiZXJyb3JcIj5BcnRpY2xlIG5vdCBmb3VuZDwvZGl2Pic7XG4gICAgICAgICAgICAgICAgLy8gQWRkIGEgYmFjayBidXR0b24gZXZlbiB3aGVuIGFydGljbGUgaXMgbm90IGZvdW5kXG4gICAgICAgICAgICAgICAgY29uc3QgYmFja0J1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgICAgICAgICAgICAgIGJhY2tCdXR0b24udGV4dENvbnRlbnQgPSAnQmFjayB0byBBcnRpY2xlcyc7XG4gICAgICAgICAgICAgICAgYmFja0J1dHRvbi5jbGFzc05hbWUgPSAnYmFjay1idXR0b24nO1xuICAgICAgICAgICAgICAgIGJhY2tCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGludGVyZXN0cyA9IHRoaXMuaW50ZXJlc3RzSW5wdXQ/LnZhbHVlIHx8ICcnO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRBcnRpY2xlcyhpbnRlcmVzdHMpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuYXJ0aWNsZXNDb250YWluZXIuYXBwZW5kQ2hpbGQoYmFja0J1dHRvbik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLnJlbmRlckFydGljbGVEZXRhaWwoYXJ0aWNsZURldGFpbCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsb2FkaW5nIGFydGljbGUgZGV0YWlsczonLCBlcnJvcik7XG4gICAgICAgICAgICB0aGlzLmFydGljbGVzQ29udGFpbmVyLmlubmVySFRNTCA9ICc8ZGl2IGNsYXNzPVwiZXJyb3JcIj5FcnJvciBsb2FkaW5nIGFydGljbGUgZGV0YWlscy4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci48L2Rpdj4nO1xuICAgICAgICAgICAgLy8gQWRkIGEgYmFjayBidXR0b24gZXZlbiB3aGVuIHRoZXJlJ3MgYW4gZXJyb3JcbiAgICAgICAgICAgIGNvbnN0IGJhY2tCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICAgICAgICAgIGJhY2tCdXR0b24udGV4dENvbnRlbnQgPSAnQmFjayB0byBBcnRpY2xlcyc7XG4gICAgICAgICAgICBiYWNrQnV0dG9uLmNsYXNzTmFtZSA9ICdiYWNrLWJ1dHRvbic7XG4gICAgICAgICAgICBiYWNrQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGludGVyZXN0cyA9IHRoaXMuaW50ZXJlc3RzSW5wdXQ/LnZhbHVlIHx8ICcnO1xuICAgICAgICAgICAgICAgIHRoaXMubG9hZEFydGljbGVzKGludGVyZXN0cyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuYXJ0aWNsZXNDb250YWluZXIuYXBwZW5kQ2hpbGQoYmFja0J1dHRvbik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcHJpdmF0ZSByZW5kZXJBcnRpY2xlRGV0YWlsKGFydGljbGU6IEFydGljbGVEZXRhaWwpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLmFydGljbGVzQ29udGFpbmVyKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICB0aGlzLmFydGljbGVzQ29udGFpbmVyLmlubmVySFRNTCA9ICcnO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgYXJ0aWNsZURldGFpbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBhcnRpY2xlRGV0YWlsLmNsYXNzTmFtZSA9ICdhcnRpY2xlLWRldGFpbCc7XG4gICAgICAgIFxuICAgICAgICAvLyBDcmVhdGUgYXJ0aWNsZSBIVE1MIGNvbnRlbnRcbiAgICAgICAgbGV0IGFydGljbGVDb250ZW50ID0gYFxuICAgICAgICAgICAgPGgyPiR7dGhpcy5lc2NhcGVIdG1sKGFydGljbGUudGl0bGUpfTwvaDI+XG4gICAgICAgIGA7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgdGhlIGZ1bGwgYXJ0aWNsZSBjb250ZW50IGlmIGF2YWlsYWJsZSwgb3RoZXJ3aXNlIGZhbGwgYmFjayB0byBzdW1tYXJ5XG4gICAgICAgIGlmIChhcnRpY2xlLmNvbnRlbnQpIHtcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIGNvbnRlbnQgYXBwZWFycyB0byBiZSBIVE1MIChjb250YWlucyB0YWdzKVxuICAgICAgICAgICAgaWYgKGFydGljbGUuY29udGVudC5pbmNsdWRlcygnPCcpICYmIGFydGljbGUuY29udGVudC5pbmNsdWRlcygnPicpKSB7XG4gICAgICAgICAgICAgICAgLy8gSXQncyBIVE1MLCBpbnNlcnQgZGlyZWN0bHkgd2l0aCBzYW5pdGl6YXRpb25cbiAgICAgICAgICAgICAgICBhcnRpY2xlQ29udGVudCArPSBgXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJhcnRpY2xlLWNvbnRlbnRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICR7dGhpcy5zYW5pdGl6ZUh0bWwoYXJ0aWNsZS5jb250ZW50KX1cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgYDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gSXQncyBtYXJrZG93biBvciBwbGFpbiB0ZXh0LCBmb3JtYXQgd2l0aCBwYXJhZ3JhcGhzXG4gICAgICAgICAgICAgICAgYXJ0aWNsZUNvbnRlbnQgKz0gYFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYXJ0aWNsZS1jb250ZW50XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAke3RoaXMuZm9ybWF0U3VtbWFyeShhcnRpY2xlLmNvbnRlbnQpfVxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICBgO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gTm8gY29udGVudCwgdXNlIHN1bW1hcnlcbiAgICAgICAgICAgIGFydGljbGVDb250ZW50ICs9IGBcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYXJ0aWNsZS1zdW1tYXJ5XCI+XG4gICAgICAgICAgICAgICAgICAgICR7dGhpcy5mb3JtYXRTdW1tYXJ5KGFydGljbGUuc3VtbWFyeSl9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICBgO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgYWN0aW9uIGJ1dHRvbnNcbiAgICAgICAgYXJ0aWNsZUNvbnRlbnQgKz0gYFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImFydGljbGUtYWN0aW9uc1wiPlxuICAgICAgICAgICAgICAgIDxhIGhyZWY9XCIke2FydGljbGUubGlua31cIiB0YXJnZXQ9XCJfYmxhbmtcIiBjbGFzcz1cImFydGljbGUtbGlua1wiPlZpZXcgT3JpZ2luYWw8L2E+XG4gICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD1cImJhY2stdG8tYXJ0aWNsZXNcIiBjbGFzcz1cImJhY2stYnV0dG9uXCI+QmFjayB0byBBcnRpY2xlczwvYnV0dG9uPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIGA7XG4gICAgICAgIFxuICAgICAgICBhcnRpY2xlRGV0YWlsLmlubmVySFRNTCA9IGFydGljbGVDb250ZW50O1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIGJhY2sgYnV0dG9uIGNsaWNrIGV2ZW50XG4gICAgICAgIGNvbnN0IGJhY2tCdXR0b24gPSBhcnRpY2xlRGV0YWlsLnF1ZXJ5U2VsZWN0b3IoJyNiYWNrLXRvLWFydGljbGVzJyk7XG4gICAgICAgIGlmIChiYWNrQnV0dG9uKSB7XG4gICAgICAgICAgICBiYWNrQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGludGVyZXN0cyA9IHRoaXMuaW50ZXJlc3RzSW5wdXQ/LnZhbHVlIHx8ICcnO1xuICAgICAgICAgICAgICAgIHRoaXMubG9hZEFydGljbGVzKGludGVyZXN0cyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdGhpcy5hcnRpY2xlc0NvbnRhaW5lci5hcHBlbmRDaGlsZChhcnRpY2xlRGV0YWlsKTtcbiAgICB9XG4gICAgXG4gICAgcHJpdmF0ZSBoYW5kbGVJbnRlcmVzdHNTdWJtaXQoKTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5pbnRlcmVzdHNJbnB1dCkgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgaW50ZXJlc3RzID0gdGhpcy5pbnRlcmVzdHNJbnB1dC52YWx1ZS50cmltKCk7XG4gICAgICAgIGNvbnNvbGUubG9nKGBJbnRlcmVzdHMgc3VibWl0dGVkOiBcIiR7aW50ZXJlc3RzfVwiYCk7XG4gICAgICAgIFxuICAgICAgICAvLyBEaXNhYmxlIHRoZSBidXR0b24gZHVyaW5nIGxvYWRpbmdcbiAgICAgICAgaWYgKHRoaXMuc3VibWl0QnV0dG9uKSB7XG4gICAgICAgICAgICB0aGlzLnN1Ym1pdEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJ3RydWUnKTtcbiAgICAgICAgICAgIHRoaXMuc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gJ0xvYWRpbmcuLi4nO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBTaG93IGxvYWRpbmcgaW5kaWNhdG9yIGluIGFydGljbGVzIGNvbnRhaW5lclxuICAgICAgICBpZiAodGhpcy5hcnRpY2xlc0NvbnRhaW5lcikge1xuICAgICAgICAgICAgdGhpcy5hcnRpY2xlc0NvbnRhaW5lci5pbm5lckhUTUwgPSAnPGRpdiBjbGFzcz1cImxvYWRpbmdcIj5TY29yaW5nIGFydGljbGVzIGJhc2VkIG9uIHlvdXIgaW50ZXJlc3RzLi4uPC9kaXY+JztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gTG9hZCBhcnRpY2xlcyB3aXRoIGludGVyZXN0c1xuICAgICAgICB0aGlzLmxvYWRBcnRpY2xlcyhpbnRlcmVzdHMpXG4gICAgICAgICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gUmUtZW5hYmxlIHRoZSBidXR0b24gd2hlbiBkb25lXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc3VibWl0QnV0dG9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3VibWl0QnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSAnVXBkYXRlIEludGVyZXN0cyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIHByaXZhdGUgZm9ybWF0U3VtbWFyeShzdW1tYXJ5OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICAvLyBSZXBsYWNlIG5ld2xpbmVzIHdpdGggcGFyYWdyYXBoIGJyZWFrc1xuICAgICAgICByZXR1cm4gc3VtbWFyeVxuICAgICAgICAgICAgLnNwbGl0KCdcXG5cXG4nKVxuICAgICAgICAgICAgLmZpbHRlcihwYXJhZ3JhcGggPT4gcGFyYWdyYXBoLnRyaW0oKS5sZW5ndGggPiAwKVxuICAgICAgICAgICAgLm1hcChwYXJhZ3JhcGggPT4gYDxwPiR7dGhpcy5lc2NhcGVIdG1sKHBhcmFncmFwaCl9PC9wPmApXG4gICAgICAgICAgICAuam9pbignJyk7XG4gICAgfVxuICAgIFxuICAgIHByaXZhdGUgZXNjYXBlSHRtbCh1bnNhZmU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB1bnNhZmVcbiAgICAgICAgICAgIC5yZXBsYWNlKC8mL2csIFwiJmFtcDtcIilcbiAgICAgICAgICAgIC5yZXBsYWNlKC88L2csIFwiJmx0O1wiKVxuICAgICAgICAgICAgLnJlcGxhY2UoLz4vZywgXCImZ3Q7XCIpXG4gICAgICAgICAgICAucmVwbGFjZSgvXCIvZywgXCImcXVvdDtcIilcbiAgICAgICAgICAgIC5yZXBsYWNlKC8nL2csIFwiJiMwMzk7XCIpO1xuICAgIH1cbiAgICBcbiAgICAvLyBIZWxwZXIgdG8gdHJ1bmNhdGUgdGV4dCB3aXRoIGVsbGlwc2lzXG4gICAgcHJpdmF0ZSB0cnVuY2F0ZVRleHQodGV4dDogc3RyaW5nLCBtYXhMZW5ndGg6IG51bWJlcik6IHN0cmluZyB7XG4gICAgICAgIGlmICghdGV4dCkgcmV0dXJuICcnO1xuICAgICAgICBpZiAodGV4dC5sZW5ndGggPD0gbWF4TGVuZ3RoKSByZXR1cm4gdGhpcy5lc2NhcGVIdG1sKHRleHQpO1xuICAgICAgICByZXR1cm4gdGhpcy5lc2NhcGVIdG1sKHRleHQuc3Vic3RyaW5nKDAsIG1heExlbmd0aCkpICsgJy4uLic7XG4gICAgfVxuXG4gICAgLy8gQmFzaWMgSFRNTCBzYW5pdGl6ZXIgdG8gYXZvaWQgWFNTIHdoaWxlIGFsbG93aW5nIGZvcm1hdHRlZCBjb250ZW50XG4gICAgcHJpdmF0ZSBzYW5pdGl6ZUh0bWwoaHRtbDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgLy8gQ3JlYXRlIGEgdGVtcG9yYXJ5IGVsZW1lbnRcbiAgICAgICAgY29uc3QgdGVtcERpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0ZW1wRGl2LmlubmVySFRNTCA9IGh0bWw7XG4gICAgICAgIFxuICAgICAgICAvLyBSZW1vdmUgcG90ZW50aWFsbHkgZGFuZ2Vyb3VzIGVsZW1lbnRzL2F0dHJpYnV0ZXNcbiAgICAgICAgY29uc3Qgc2NyaXB0cyA9IHRlbXBEaXYucXVlcnlTZWxlY3RvckFsbCgnc2NyaXB0Jyk7XG4gICAgICAgIHNjcmlwdHMuZm9yRWFjaChzY3JpcHQgPT4gc2NyaXB0LnJlbW92ZSgpKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGlmcmFtZXMgPSB0ZW1wRGl2LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lmcmFtZScpO1xuICAgICAgICBpZnJhbWVzLmZvckVhY2goaWZyYW1lID0+IGlmcmFtZS5yZW1vdmUoKSk7XG4gICAgICAgIFxuICAgICAgICAvLyBSZW1vdmUgb24qIGF0dHJpYnV0ZXNcbiAgICAgICAgY29uc3QgYWxsRWxlbWVudHMgPSB0ZW1wRGl2LnF1ZXJ5U2VsZWN0b3JBbGwoJyonKTtcbiAgICAgICAgYWxsRWxlbWVudHMuZm9yRWFjaChlbCA9PiB7XG4gICAgICAgICAgICBBcnJheS5mcm9tKGVsLmF0dHJpYnV0ZXMpLmZvckVhY2goYXR0ciA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGF0dHIubmFtZS5zdGFydHNXaXRoKCdvbicpIHx8IGF0dHIubmFtZSA9PT0gJ2hyZWYnICYmIGF0dHIudmFsdWUuc3RhcnRzV2l0aCgnamF2YXNjcmlwdDonKSkge1xuICAgICAgICAgICAgICAgICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUoYXR0ci5uYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdGVtcERpdi5pbm5lckhUTUw7XG4gICAgfVxufVxuXG4vLyBJbml0aWFsaXplIHRoZSBhcHAgd2hlbiBET00gaXMgbG9hZGVkXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4ge1xuICAgIG5ldyBBcHBDb250cm9sbGVyKCk7XG59KTsgIl0sIm5hbWVzIjpbInByZXByb2Nlc3MiLCJ0ZXh0IiwidG9Mb3dlckNhc2UiLCJyZXBsYWNlIiwic3BsaXQiLCJmaWx0ZXIiLCJCb29sZWFuIiwibGV2ZW5zaHRlaW5TaW1pbGFyaXR5IiwiYSIsImIiLCJtIiwibGVuZ3RoIiwibiIsImRwIiwiQXJyYXkiLCJmcm9tIiwiZmlsbCIsImkiLCJqIiwiY29zdCIsIk1hdGgiLCJtaW4iLCJtYXgiLCJqYWNjYXJkU2ltaWxhcml0eSIsImFUb2tlbnMiLCJiVG9rZW5zIiwic2V0QSIsIlNldCIsInNldEIiLCJpbnRlcnNlY3Rpb24iLCJ4IiwiaGFzIiwidW5pb24iLCJ0b2tlbk92ZXJsYXAiLCJtYXRjaCIsIndvcmQiLCJpbmNsdWRlcyIsImNvbXB1dGUiLCJzbWFsbCIsImxhcmdlIiwidGhpcyIsInNtYWxsQ2xlYW4iLCJqb2luIiwibGFyZ2VDbGVhbiIsInNjb3JlIiwicm91bmQiLCJiYXNlVXJsIiwid2luZG93IiwibG9jYXRpb24iLCJob3N0bmFtZSIsImNvbnNvbGUiLCJsb2ciLCJnZXRBcnRpY2xlcyIsImludGVyZXN0cyIsInF1ZXJ5UGFyYW1zIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwidXJsIiwiZmV0Y2giLCJyZXNwb25zZSIsIm9rIiwiZXJyb3IiLCJzdGF0dXMiLCJFcnJvciIsInN0YXR1c1RleHQiLCJqc29uIiwiZGF0YSIsIm1hcCIsImFydGljbGUiLCJpZCIsInRpdGxlIiwic3ViamVjdCIsImxpbmsiLCJzdW1tYXJ5IiwiZ2V0QXJ0aWNsZURldGFpbHMiLCJhcnRpY2xlSWQiLCJjb250ZW50IiwiYW5hbHl6ZUludGVyZXN0cyIsIm1ldGhvZCIsImhlYWRlcnMiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFwaVNlcnZpY2UiLCJBcGlTZXJ2aWNlIiwiYXJ0aWNsZXNDb250YWluZXIiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiaW50ZXJlc3RzSW5wdXQiLCJzdWJtaXRCdXR0b24iLCJpbml0RXZlbnRMaXN0ZW5lcnMiLCJsb2FkQXJ0aWNsZXMiLCJhZGRFdmVudExpc3RlbmVyIiwiaGFuZGxlSW50ZXJlc3RzU3VibWl0IiwiaW5uZXJIVE1MIiwiYXJ0aWNsZXMiLCJkZWR1cGxpY2F0ZUFydGljbGVzIiwic2NvcmluZ1Byb21pc2VzIiwidXNlckludGVyZXN0cyIsImFydGljbGVDb2xsZWN0aW9uIiwiYmFzZVNjb3JlIiwiZmxvb3IiLCJyYW5kb20iLCJ0cmltIiwiaW50ZXJlc3RUZXJtcyIsInRlcm0iLCJhcnRpY2xlU3VtbWFyeSIsInN1bW1hcnlTb3VyY2UiLCJzdW1tYXJ5UGF0aCIsInN1bW1hcnlEYXRhIiwic3Vic3RyaW5nIiwid2FybiIsInRpdGxlVGV4dCIsInN1YmplY3RUZXh0IiwiYXJ0aWNsZUZ1bGxUZXh0Iiwic2ltaWxhcml0eVNjb3JlIiwicmF3U2ltaWxhcml0eSIsIlNpbWlsYXJpdHlTY29yZXIiLCJ0b0ZpeGVkIiwiaW50ZXJlc3RUb2tlbnMiLCJhcnRpY2xlVG9rZW5zIiwibGV2U2ltIiwic2xpY2UiLCJqYWNTaW0iLCJ0b2tTaW0iLCJjb250ZXh0dWFsU2NvcmUiLCJ0aXRsZUltcG9ydGFuY2UiLCJzb21lIiwidGl0bGVTaW1pbGFyaXR5Iiwic3ViamVjdFNpbWlsYXJpdHkiLCJ3ZWlnaHRlZENvbnRleHRTaW1pbGFyaXR5IiwiZnJlc2huZXNzU2NvcmUiLCJiYXNlRnJlc2huZXNzIiwicGFyc2VJbnQiLCJ0aXRsZVdvcmRzIiwidyIsImZvckVhY2giLCJvY2N1cnJlbmNlQ291bnQiLCJ0IiwidW5pcXVlbmVzc0JvbnVzIiwiZmluYWxTY29yZSIsInNjb3JlQnJlYWtkb3duIiwic2ltaWxhcml0eSIsImNvbnRleHR1YWwiLCJmcmVzaG5lc3MiLCJmaW5hbCIsInNjb3JlQ29tcG9uZW50cyIsImN1c3RvbVJhbmtpbmdTeXN0ZW0iLCJQcm9taXNlIiwiYWxsIiwic2NvcmVkQXJ0aWNsZXMiLCJpbmRleCIsInNvcnQiLCJyZW5kZXJBcnRpY2xlcyIsInVuaXF1ZVRpdGxlcyIsIm5vcm1hbGl6ZWRUaXRsZSIsImFkZCIsImFydGljbGVzR3JpZCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJzdHlsZSIsImRpc3BsYXkiLCJncmlkVGVtcGxhdGVDb2x1bW5zIiwiZ2FwIiwicGFkZGluZyIsImxpbmtQYXJ0cyIsInRpdGxlU2x1ZyIsIkRhdGUiLCJub3ciLCJ0b1N0cmluZyIsInN1bW1hcnlUZXh0Iiwic3RhcnRzV2l0aCIsImFydGljbGVDYXJkIiwiYm9yZGVyIiwiYm9yZGVyUmFkaXVzIiwib3ZlcmZsb3ciLCJib3hTaGFkb3ciLCJiYWNrZ3JvdW5kQ29sb3IiLCJ0cmFuc2l0aW9uIiwiaGVpZ2h0IiwiZmxleERpcmVjdGlvbiIsInRyYW5zZm9ybSIsImJhZGdlQ29sb3IiLCJlc2NhcGVIdG1sIiwidHJ1bmNhdGVUZXh0IiwiYXJ0aWNsZUxpbmsiLCJxdWVyeVNlbGVjdG9yIiwiZSIsInByZXZlbnREZWZhdWx0IiwiY2xpY2tlZElkIiwiZ2V0QXR0cmlidXRlIiwidmlld0FydGljbGVEZXRhaWxzIiwidG9nZ2xlRWxlbWVudHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaGlkZVRvZ2dsZSIsImFwcGVuZENoaWxkIiwiZGVidWdJbmZvIiwidGV4dENvbnRlbnQiLCJ0ZXh0QWxpZ24iLCJtYXJnaW5Ub3AiLCJmb250U2l6ZSIsImNvbG9yIiwiYXJ0aWNsZURldGFpbCIsInJlbmRlckFydGljbGVEZXRhaWwiLCJiYWNrQnV0dG9uIiwidmFsdWUiLCJhcnRpY2xlQ29udGVudCIsInNhbml0aXplSHRtbCIsImZvcm1hdFN1bW1hcnkiLCJzZXRBdHRyaWJ1dGUiLCJmaW5hbGx5IiwicmVtb3ZlQXR0cmlidXRlIiwicGFyYWdyYXBoIiwidW5zYWZlIiwibWF4TGVuZ3RoIiwiaHRtbCIsInRlbXBEaXYiLCJzY3JpcHQiLCJyZW1vdmUiLCJpZnJhbWUiLCJlbCIsImF0dHJpYnV0ZXMiLCJhdHRyIiwibmFtZSIsIkFwcENvbnRyb2xsZXIiXSwic291cmNlUm9vdCI6IiJ9